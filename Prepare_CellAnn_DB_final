####
#### this is the final script to prepare the raw data sets in the database ####
####

####
####
####

#### First we write a function ####
#### input is a folder ############
#### search the seurat file in that folder ######
####
#### this is on the new server: ###
####

ssh plyu3@omb2.onc.jhmi.edu
U[9C20&&

conda activate seurat4

#### I want to copy the folder to my own folder !!!! #####

cp -r "/zp1/data/yzhai11/UCSC/" "/zp1/data/plyu3/UCSC/"

####
input_folder_example = "/zp1/data/plyu3/UCSC/pmid27667365_Human pancreas"
input_folder = input_folder_example

####
####
####
####
R

Read_Seurat_file_in_the_folder_UCSC <- function(input_folder){
	##### first we init a table ######
	checked_items = c('Seurat_files_exists:','Seurat_file_celltypes:','Seurat_file_dims:','Seurat_file_matrix_equal:','Seurat_file_matrix_max:','Seurat_file_matrix_log:','Seurat_file_matrix_log2:','Seurat_file_matrix_counts:','Seurat_file_Genes:','Seurat_file_matrix_counts_sum:')
	##### 
	checked_table = data.frame(checked_items=checked_items,results="Need to check!")
	##### loading library !!! #####
	library(Seurat)
	##### we first go into the folder ######
	setwd(input_folder)
	##### 'Seurat_files_exists:' #####
	files = list.files()
	#####
	##### searching seurat files ########
	##### 
	k = grep("_seurat_obj$",files)
	#####
	if(length(k) != 1){
		checked_table$results[1] = 'No file!'
		write.table(checked_items,file='checked_items.txt',sep="\t",quote=F,row.names=F)
		return(checked_items)
	}
	if(length(k) == 1){
		checked_table$results[1] = 'OK!'
		###### Next we will load the seurat objects !!!! ##########
		seurat_file = files[k]
		seurat_obj <- readRDS(seurat_file)
		###### Next we will check whether celltype exists: ########
		k1 = which(colnames(seurat_obj@meta.data) == "celltype")
		if(length(k1) != 1){
			checked_items$results[2] = 'No celltype!'
			write.table(checked_table,file='checked_items.txt',sep="\t",quote=F,row.names=F)
			return(checked_items)
		}
		if(length(k) == 1){
			checked_table$results[2] = 'OK!'
			###### Next we will check the dims !!!! ##############
			k2 = which(colnames(seurat_obj@meta.data) %in% c("dim1","dim2","dim3") == T)
			if(length(k2) < 2){
				checked_table$results[3] = 'No dims!'
				write.table(checked_table,file='checked_items.txt',sep="\t",quote=F,row.names=F)
				return(checked_items)
			}
			if(length(k2) > 1){
				checked_table$results[3] = 'OK!'
				##### Next check whether matrix is equal!!! #######
				##### RNA@data matrix and RNA@counts matrix #######
				data_mat = seurat_obj[['RNA']]@data[1:100,1:100]
				count_mat = seurat_obj[['RNA']]@counts[1:100,1:100]
				#####
				res = all.equal(data_mat,count_mat)
				#####
				checked_table$results[4] = res
				#####
				count_mat = seurat_obj[['RNA']]@counts[,1:100]
				max = max(as.vector(count_mat))
				#####
				if(max < 20){
					checked_table$results[5] = max
				}
				if(max > 50){
					checked_table$results[5] = max
				}
				####### top5 sums #####
				####
				sums = as.character(round(Matrix::colSums(exp(count_mat))[1:5],2))
				####
				sums_res = paste(sums,collapse='::')
				####
				checked_table$results[6] = sums_res
				####
				sums = as.character(round(Matrix::colSums(2^(count_mat))[1:5],2))
				sums_res = paste(sums,collapse='::')
				checked_table$results[7] = sums_res
				####
				sums = as.character(round(Matrix::colSums(count_mat)[1:5],2))
				sums_res = paste(sums,collapse='::')
				checked_table$results[10] = sums_res
				#### print the non-Zero number in the matrix #######
				####
				count_mat_v <- as.vector(count_mat)
				count_mat_v = count_mat_v[which(count_mat_v > 0)]
				count_mat_v = round(count_mat_v,3)
				sums_res = paste(count_mat_v[1:5],collapse='::')
				checked_table$results[8] = sums_res
				#### 
				######## Next we will check the genes !!! ##########
				####
				#### plot the first rownames of the seurat objects !!! #####
				####
				Genes = rownames(seurat_obj)[1:5]
				####
				sums_res = paste(Genes[1:5],collapse='::')
				checked_table$results[9] = sums_res
				####
				write.table(checked_table,file='checked_items.txt',sep="\t",quote=F,row.names=F)
				return(checked_table)
			}
		}
	}
	#####
	#####
}

######
######
###### add dims from seurat objects metadata to seurat inside #######
######
######
######
###### ###### ######

Prepare_Seurat_file_in_the_folder_UCSC <- function(input_folder,norm="log"){
	#########
	library(Seurat)
	##### we first go into the folder ######
	setwd(input_folder)
	##### 'Seurat_files_exists:' #####
	files = list.files()
	#####
	##### searching seurat files ########
	##### 
	k = grep("_seurat_obj$",files)
	#####
	#########
	seurat_file = files[k]
	seurat_obj <- readRDS(seurat_file)
	print(dim(seurat_obj))
	#########
	if(dim(seurat_obj)[2] > 25000){
		index = sample(1:dim(seurat_obj)[2],25000)
		seurat_obj = seurat_obj[,index]
	}
	##### first we convert matrix to counts ##########
	if(norm == "log"){
		######
		mat = seurat_obj[['RNA']]@counts
		mat_new = exp(mat)-1
		######
	}
	if(norm == "counts"){
		######
		mat = seurat_obj[['RNA']]@counts
		mat_new = mat
		######
	}
	if(norm == "log2"){
		######
		mat = seurat_obj[['RNA']]@counts
		mat_new = 2^(mat)-1
		######
	}
	#####
	seurat_obj_new = CreateSeuratObject(mat_new)
	seurat_obj_new@meta.data = seurat_obj@meta.data
	#####
	##### next we add dims to this seurat_obj #######
	#####
	dims_index = c("dim1","dim2","dim3")
	k = match(dims_index,colnames(seurat_obj_new@meta.data))
	k = k[is.na(k) == F]
	UMAPs_mat = as.matrix(seurat_obj@meta.data[,k])
	UMAPs_mat_new = Norm_UMAPs(UMAPs_mat)
	#####
	#####
	#####
	seurat_obj_new[['dims']] <- CreateDimReducObject(embeddings = UMAPs_mat_new, key = "dims_", assay = 'RNA')
	#####
	#png_file = paste0("dim_check.png")
	#png(png_file,height=5000,width=6000,res=72*12)
	#print(DimPlot(seurat_obj_new, reduction = "dims",group.by=c('celltype'),label = TRUE, label.size = 2.5, repel = TRUE,raster = FALSE))
	#dev.off()
	###### 
	###### Next we will create the files #######
	######
	seurat_file_new = paste(seurat_file,'_new',sep="")
	######
	saveRDS(seurat_obj_new,file=seurat_file_new)
}



#### OK!!! ######
#### then we write small functions ########
####

#### 这个是OK的 ！！！##### 
####
Norm_UMAPs <- function(UMAPs_mat){
	#### each rows and cols norms to the -50 50 dims #######
	####
	UMAPs_mat_new = UMAPs_mat
	####
	for(i in 1:dim(UMAPs_mat)[2]){
		tmp_vector = UMAPs_mat[,i]
		tmp_vector_mean = tmp_vector - mean(tmp_vector)
		tmp_vector_scale = 100 / (max(tmp_vector) - min(tmp_vector))
		tmp_vector_norm = tmp_vector_mean*tmp_vector_scale
		UMAPs_mat_new[,i] = round(tmp_vector_norm,3)
	}
	####
	return(UMAPs_mat_new)
}




#### #####
#### we will need to know the UCSC processing piplines #####
#### #####

####
#### Next we will prepare the Dim files and the markers and the celltype submarkers #############
#### Input is the seurat_obj ####################################################################
#### call sub clusters and call sub markers #######
####
#### this is the runDEGs_Ref ######
####

runDEGs_Ref <- function(Seurat_Obj,method='COSG',idents='celltype',num_of_genes = 100){
	Idents(Seurat_Obj) = idents
	#######
	library(COSG)
	#######
	if(method == 'COSG'){
		marker_cosg <- cosg(
 				Seurat_Obj,
 				groups=c('all'),
 				assay='RNA',
 				slot='data',
 				mu=1,
 				n_genes_user=num_of_genes)
		res = marker_cosg$names
	}
	#######
	#######
	return(res)
}

#####
#####
##### input is the log transformed matrix #######
#####
#####

CellAnn_Avg_Mat <- function(data_mat,data_cluster,log='log',scale_factor=10000){
	######
	tag_cluster = unname(data_cluster)
	tag_cluster_level = levels(as.factor(tag_cluster))
	###### normalized back datasets ######
	if(log == 'log'){
		data_mat_exp = exp(data_mat)
		data_mat_exp = data_mat_exp-1
	}
	if(log == 'log2'){
		data_mat_exp = 2^(data_mat)
		data_mat_exp = data_mat_exp-1
	}
	print(paste('Sums:',head(colSums(data_mat_exp[,c(1:2)]))))
	###### data_mat_exp is 1e5 normalize #######
	merge_mat = c()
	for(i in 1:length(tag_cluster_level)){
		index = which(data_cluster %in% tag_cluster_level[i] == T)
		index_mat = data_mat_exp[,index]
		######
		index_sum = rowSums(index_mat)
		######
		merge_mat = c(merge_mat,index_sum)
	}
	###
	merge_mat = matrix(merge_mat,nrow=dim(data_mat)[1])
	###
	rownames(merge_mat) = rownames(data_mat)
	colnames(merge_mat) = tag_cluster_level
	### colSums(merge_mat)
	scale = colSums(merge_mat)/scale_factor
	merge_mat = sweep(merge_mat,2,scale,FUN='/')
	### default norm ####
	merge_mat = round(log(merge_mat+1),3)
	return(merge_mat)
	### return is a log transformed matrix ####
}

##############
############## this function subset each celltype annotation ######
############## keys = "celltype"
############## 变成 subset seurat ##################################
############## 

subset_each_ct <- function(data,resolution){
	#####
	matrix_list = list()
	##### ct ######
	ct = levels(as.factor(data$celltype))
	#####
	cells_list = list()
	#####
	for(j in 1:length(ct)){
		print(ct[j])
		#######
		k = which(data$celltype == ct[j])
		#######
		if(length(k) > 1){
			print('large')
			#######
			sub_seurat = subset(data,subset = celltype == ct[j])
			#######
			dim_length = dim(sub_seurat@reductions$dims@cell.embeddings)[2]
			#######
			sub_seurat = FindNeighbors(sub_seurat,reduction="dims",dims=c(1:dim_length))
			sub_seurat = FindClusters(sub_seurat,resolution=resolution)
			sub_seurat_mat = sub_seurat[['RNA']]@data
			data_cluster = sub_seurat$seurat_clusters
			data_cluster = paste(ct[j],data_cluster,sep='@sub')
			sub_seurat_avg = CellAnn_Avg_Mat(data_mat=sub_seurat_mat,data_cluster)
			matrix_list = c(matrix_list,list(sub_seurat_avg))
			######
			cells_table = data.frame(cells=colnames(sub_seurat_mat),new_sub_cluster = data_cluster)
			cells_list = c(cells_list,list(cells_table))
		}
	}
	matrix_list = do.call('cbind',matrix_list)
	cells_list = do.call('rbind',cells_list)
	####
	return(list(matrix_list,cells_list))
}


######
######

Prepare_Seurat_file_in_the_folder_UCSC_STEP2 <- function(input_folder){
	#########
	library(Seurat)
	##### we first go into the folder ######
	setwd(input_folder)
	##### 'Seurat_files_exists:' #####
	files = list.files()
	#####
	##### searching seurat files ########
	##### 
	k = grep("_seurat_obj_new$",files)
	#####
	#########
	seurat_file = files[k]
	seurat_obj <- readRDS(seurat_file)
	######### Performing log-normalization ###########
	##### first we convert matrix to counts ##########
	seurat_obj <- NormalizeData(seurat_obj)
	#####
	#####
	subset_matrix_res = subset_each_ct(seurat_obj,resolution=0.5)
	##### OK! what is the next ? #####################
	#####
	subset_matrix = subset_matrix_res[[1]]
	subset_cell = subset_matrix_res[[2]]
	#####
	m = match(colnames(seurat_obj),subset_cell$cells)
	seurat_obj$cell_id = subset_cell$cells[m]
	seurat_obj$celltype_sub = subset_cell$new_sub_cluster[m]
	#####
	##### OK!!! we finished annotation these cells, next to check to see the results: #########
	#####
	png_file = paste0("sub_ct_check.png")
	png(png_file,height=5000,width=26000,res=72*12)
	print(DimPlot(seurat_obj, reduction = "dims",group.by=c('celltype_sub'),label = FALSE,raster = FALSE))
	dev.off()
	###### OK!! Next we will see the results !!! ############
	###### first we generate the avg expression matrix !!! ##
	######
	celltype_avg = CellAnn_Avg_Mat(seurat_obj[['RNA']]@data,seurat_obj$celltype)
	sub_celltype_avg = CellAnn_Avg_Mat(seurat_obj[['RNA']]@data,seurat_obj$celltype_sub)
	###### then we will call markers ########################
	######
	celltype_marker = runDEGs_Ref(seurat_obj,method='COSG',idents='celltype',num_of_genes=100)
	sub_celltype_marker = runDEGs_Ref(seurat_obj,method='COSG',idents='celltype_sub',num_of_genes=100)
	###### then we will save these files ####################
	######
	saveRDS(seurat_obj,file=files[k])
	######
	saveRDS(celltype_avg,file=paste0(files[k],"_avg_mat"))
	saveRDS(sub_celltype_avg,file=paste0(files[k],"_avg_sub_mat"))
	saveRDS(celltype_marker,file=paste0(files[k],"_marker"))
	saveRDS(sub_celltype_marker,file=paste0(files[k],"_sub_marker"))
	######
	###### also need to provide dimplot file !! #######
	###### 
	dim_files = data.frame(seurat_obj@reductions$dims@cell.embeddings)
	dim_files_width = dim(dim_files)[2]
	colnames(dim_files) <- paste0("dim",1:dim_files_width)
	######
	dim_files$cluster = seurat_obj$celltype
	###### re-order dim files #######
	dim_files = dim_files[,c(dim_files_width+1,1:dim_files_width)]
	print(head(dim_files))
	saveRDS(dim_files,file=paste0(files[k],"_Dimplot"))
	######
	print("Finished !!!")
}

########## should convert to “pmid” + PMID number + “_Dimplot” tags ######
##########

Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder <- function(From_folder,To_folder,TAG){
	############# we need to search files in the From_folder ##########
	setwd(From_folder)
	#############
	files = list.files()
	#############
	### first: "_avg_mat" ##
	k1 = grep("_avg_mat$",files)
	k2 = grep("_avg_sub_mat$",files)
	k3 = grep("_Dimplot$",files)
	k4 = grep("new_marker$",files)
	k5 = grep("new_sub_marker$",files)
	#############
	file_avg_mat_target = paste0('pmid',TAG,'_avg_mat')
	file_avg_sub_mat_target = paste0('pmid',TAG,'_avg_sub_mat')
	file_Dimplot_target = paste0('pmid',TAG,'_Dimplot')
	file_marker_target = paste0('pmid',TAG,'_marker')
	file_sub_marker_target = paste0('pmid',TAG,'_sub_marker')
	#############
	file_avg_mat_target2 = paste0(To_folder,file_avg_mat_target)
	file_avg_sub_mat_target2 = paste0(To_folder,file_avg_sub_mat_target)
	file_Dimplot_target2 = paste0(To_folder,file_Dimplot_target)
	file_marker_target2 = paste0(To_folder,file_marker_target)
	file_sub_marker_target2 = paste0(To_folder,file_sub_marker_target)
	############# we use a command to copy these files ####################
	#############
	command1 = paste('cp',files[k1],file_avg_mat_target2)
	command2 = paste('cp',files[k2],file_avg_sub_mat_target2)
	command3 = paste('cp',files[k3],file_Dimplot_target2)
	command4 = paste('cp',files[k4],file_marker_target2)
	command5 = paste('cp',files[k5],file_sub_marker_target2)
	print(command1)
	print(command2)
	print(command3)
	print(command4)
	print(command5)
	#############
	system(command1)
	system(command2)
	system(command3)
	system(command4)
	system(command5)
	##############
	Datasheet_table = data.frame(PMID=TAG,reference_index=paste0('pmid',TAG),reference_avg_mat=file_avg_mat_target,reference_avg_sub_mat=file_avg_sub_mat_target,reference_marker=file_marker_target,reference_sub_marker=file_sub_marker_target)
	##############
	setwd(To_folder)
	files = list.files()
	##############
	k6 = grep("reference_table2_add.txt",files)
	##############
	if(length(k6) == 0){
		##### then we write it as a new table ############
		write.table(Datasheet_table,file="reference_table2_add.txt",sep="\t",row.names=F,quote=F)
	}
	if(length(k6) > 0){
		print("Find!!!")
		##### then we write it as a new table ############
		Datasheet_table_Ori = read.table(files[k6],sep="\t",header=T)
		#####
		Datasheet_table = rbind(Datasheet_table_Ori,Datasheet_table)
		#####
		Datasheet_table = Datasheet_table[!duplicated(Datasheet_table$PMID),]
		#####
		write.table(Datasheet_table,file="reference_table2_add.txt",sep="\t",row.names=F,quote=F)
	}
}


###########
###########
########### OK!!! we need to first provide the additional tables for table2 and total tables ###########
###########
###########

we will create a new folder 

cd /zp1/data/plyu3

mkdir /zp1/data/plyu3/CellAnn_batch1

###########
########### OK!!! let us to start !!!! #######
###########
########### Open the table in the cellAnn db ################
###########
27062923_Human_preimplant_embryos
Single-Cell RNA-Seq Reveals Lineage and X Chromosome Dynamics in Human Preimplantation Embryos

pmid27062923_Human preimplant embryos

Read_Seurat_file_in_the_folder_UCSC("/zp1/data/plyu3/UCSC/pmid27062923_Human preimplant embryos")

########### Not used !!! ########
########### red #################
###########

pmid27667365_Human pancreas

folder = "/zp1/data/plyu3/UCSC/pmid27667365_Human pancreas"
to = "/zp1/data/plyu3/CellAnn_batch1/"
TAG = "27667365_Human_pancreas"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

###########
########### Next another study !!! ######
folder = "/zp1/data/plyu3/UCSC/pmid28279351_H1 human embryonic stem cells"
to = "/zp1/data/plyu3/CellAnn_batch1/"
TAG = "28279351_H1"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

########### Next !!! #############
folder = "/zp1/data/plyu3/UCSC/pmid28846088_Human brain"
TAG = "28846088_Human_brain"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


folder = "/zp1/data/plyu3/UCSC/pmid29091775_Human Glioblastoma"
TAG = "28846088_Human_Glioblastoma"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)



###########
########### Next !!!! #############
########### OK!!!! let do it another 5 samples !!!!! #######
###########

folder = "/zp1/data/plyu3/UCSC/pmid29980650_Kidney Inflammatory Response"
TAG = "29980650_Kidney"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


########## 
folder = "/zp1/data/plyu3/UCSC/pmid30726734_Neonatal and Adult Human Testis"
TAG = "30726734_Neonatal_Testis"

Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

###########

folder = "/zp1/data/plyu3/UCSC/pmid31097668_Autism patients cortex"
TAG = "31097668_cortex"

Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log2")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

###########
folder = "/zp1/data/plyu3/UCSC/pmid31348891_Human Colon during Ulcerative Colitis/Epithelium"
TAG = "331348891_Human_Colon_Epithelium"

Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)



folder = "/zp1/data/plyu3/UCSC/pmid31348891_Human Colon during Ulcerative Colitis/Fibroblasts"
TAG = "331348891_Human_Colon_Fibroblasts"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)



folder = "/zp1/data/plyu3/UCSC/pmid31348891_Human Colon during Ulcerative Colitis/Immune"
TAG = "331348891_Human_Colon_Immune"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


####### OK!!! Next paper !!! ######
#######


folder = "/zp1/data/plyu3/UCSC/pmid31511693_Human hPSCs"
TAG = "31511693_Human_hPSCs"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


#######
folder = "/zp1/data/plyu3/UCSC/pmid31554641_Proliferating Glioblastoma Cells"
TAG = "31554641_Human_Glioblastoma"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


#######
#######
#######



cd /zp1/data/plyu3

mkdir /zp1/data/plyu3/CellAnn_batch2/

to = "/zp1/data/plyu3/CellAnn_batch2/"

#######
#######

folder = "/zp1/data/plyu3/UCSC/pmid31558434_COVID-19 Nasal sample"
TAG = "31558434_COVID-19"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


########

folder = "/zp1/data/plyu3/UCSC/pmid31597962_Human fetal liver haematopoiesis"
TAG = "31597962_Human_fetal_liver"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


#########
folder = "/zp1/data/plyu3/UCSC/pmid31892341_ lung spleen esophagus after cold preservation/Lung"
TAG = "31892341_lung"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


#########
folder = "/zp1/data/plyu3/UCSC/pmid31892341_ lung spleen esophagus after cold preservation/Spleen"
TAG = "31892341_Spleen"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


#########

folder = "/zp1/data/plyu3/UCSC/pmid31892341_ lung spleen esophagus after cold preservation/Esophagus"
TAG = "31892341_Esophagus"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)
###########

###
folder = "/zp1/data/plyu3/UCSC/pmid31950241_Human Testis integrated dataset"
TAG = "31950241_Human_Testis"
Read_Seurat_file_in_the_folder_UCSC(folder)
### Not work!!! #####


folder = "/zp1/data/plyu3/UCSC/pmid31996853_Cortical organoids/Organoids"
TAG = "31996853_Cortical_organoids"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


folder = "/zp1/data/plyu3/UCSC/pmid31996853_Cortical organoids/Primary"
TAG = "31996853_Cortical_primary"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#### 
folder = "/zp1/data/plyu3/UCSC/pmid32049002_Human multiple organoids and fetal brain"
TAG = "32049002_Human"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


####
folder = "/zp1/data/plyu3/UCSC/pmid32066951_Colon immune cells"
TAG = "32066951_Colon"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

####
folder = "/zp1/data/plyu3/UCSC/pmid32079746_Fetal Thymus/Epithelial"
TAG = "32079746_Fetal_Thymus_Epithelial"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)



folder = "/zp1/data/plyu3/UCSC/pmid32079746_Fetal Thymus/HSC"
TAG = "32079746_Fetal_Thymus_HSC"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

folder = "/zp1/data/plyu3/UCSC/pmid32079746_Fetal Thymus/MatureT"
TAG = "32079746_Fetal_Thymus_MatureT"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)



folder = "/zp1/data/plyu3/UCSC/pmid32123174_Human Ovary"
TAG = "32123174_Human_Ovary"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#########
######## Next #######
##########
### red ####
### red #### something wrong !!! ######

### move to batch to = "/zp1/data/plyu3/CellAnn_batch8/"

folder = "/zp1/data/plyu3/UCSC/pmid32214235_Human cell landscape"
TAG = "32214235_Human_cell_landscape"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log2")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#####
folder = "/zp1/data/plyu3/UCSC/pmid32246845_Human lungs and HBECs in COVID-19 pathogenesis/Lung"
TAG = "32246845_Human_Lung"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


folder = "/zp1/data/plyu3/UCSC/pmid32246845_Human lungs and HBECs in COVID-19 pathogenesis/Airways"
TAG = "32246845_Human_Airways"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)




########
######## OK!!! Next is batch3 !!! ###########
########


cd /zp1/data/plyu3

mkdir /zp1/data/plyu3/CellAnn_batch3/

to = "/zp1/data/plyu3/CellAnn_batch3/"


#######
folder = "/zp1/data/plyu3/UCSC/pmid32398875_BALF immune cells in Covid19"
TAG = "32398875_BALF"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


folder = "/zp1/data/plyu3/UCSC/pmid32427931_Smoking Effect on Human Airway Epithelium"
TAG = "32427931_Smoking"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


folder = "/zp1/data/plyu3/UCSC/pmid32499656_Human macrophage development"
TAG = "32499656_Human_macrophage"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


####### red ###
to = "/zp1/data/plyu3/CellAnn_batch8/"
folder = "/zp1/data/plyu3/UCSC/pmid32591762_COVID-19 airways"
TAG = "32591762_COVID-19"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


folder = "/zp1/data/plyu3/UCSC/pmid32603604_Sputum cells from Cystic Fibrosis patients"
TAG = "32603604_Sputum"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


folder = "/zp1/data/plyu3/UCSC/pmid32726565_Human healthy airways"
TAG = "32726565_Human_airways"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


folder = "/zp1/data/plyu3/UCSC/pmid32764665_Covid19 cytokine storm"
TAG = "32764665_Covid19"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


folder = "/zp1/data/plyu3/UCSC/pmid32788748_COVID19 immune response"
TAG = "32788748_COVID19"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)




folder = "/zp1/data/plyu3/UCSC/pmid32832598_Pulmonary fibrosis lungs"
TAG = "32832598_Pulmonary"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


#### red ###### next round !!!! ########
####
####

folder = "/zp1/data/plyu3/UCSC/pmid32929266_endometrium cycle"
TAG = "32929266_endometrium"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#####



folder = "/zp1/data/plyu3/UCSC/pmid32946807_Human digestive tract"
TAG = "32946807_Human_digestive_tract"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


######

folder = "/zp1/data/plyu3/UCSC/pmid32968047_Human teeth"
TAG = "32968047_Human_teeth"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)




folder = "/zp1/data/plyu3/UCSC/pmid32971526_Adult human heart"
TAG = "32971526_human_heart"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)



folder = "/zp1/data/plyu3/UCSC/pmid33140061_Oral cavity in COVID-19"
TAG = "33140061_Oral_cavity"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


#####
##### some thing wrong !!!!!! ##################
#####

##### "red" #######
#####

folder = "/zp1/data/plyu3/UCSC/pmid33184181_Human fetal cell atlas"
TAG = "33184181_Human_fetal"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


folder = "/zp1/data/plyu3/UCSC/pmid33208946_Human Lung"
TAG = "33184181_Human_Lung"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


folder = "/zp1/data/plyu3/UCSC/pmid33259798_Human airway basal stem cells"
TAG = "33259798_Human_airway_basal"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

############# ##############
############# ##############
############# Next !!!! #####
############# ##############
############# ##############
#############


folder = "/zp1/data/plyu3/UCSC/pmid33290721_Developing human gut/Fetal"
TAG = "33290721_Developing_human_gut_Fetal"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)




folder = "/zp1/data/plyu3/UCSC/pmid33290721_Developing human gut/Pediatric"
TAG = "33290721_Developing_human_gut_Pediatric"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)





folder = "/zp1/data/plyu3/UCSC/pmid33361824_Nasal samples from COVID-19 patients with hypertension"
TAG = "33361824_Nasal"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)



folder = "/zp1/data/plyu3/UCSC/pmid33479125_Healthy Human Skin"
TAG = "33479125_Human_Skin"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)




folder = "/zp1/data/plyu3/UCSC/pmid33713619_Immune cells in Severe Covid19/Adaptive"
TAG = "33713619_Immune_Adaptive"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)




folder = "/zp1/data/plyu3/UCSC/pmid33713619_Immune cells in Severe Covid19/Innate"
TAG = "33713619_Immune_Innate"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


folder = "/zp1/data/plyu3/UCSC/pmid33758880_Pediatric COVID PBMC and Nasal/PBMC"
TAG = "33758880_Pediatric_PBMC"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)




folder = "/zp1/data/plyu3/UCSC/pmid33758880_Pediatric COVID PBMC and Nasal/Nasal"
TAG = "33758880_Pediatric_Nasal"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


################# here !!!! yellow ########
###### Next !!!!! ######## yellow  ########
################# ######## yellow #########


folder = "/zp1/data/plyu3/UCSC/pmid33865984_Human cornea"
TAG = "33865984_Human_cornea"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#### red ########################
#### red ########################
#### something wrong !!!!! ######
#### red ########################
#### red ########################

folder = "/zp1/data/plyu3/UCSC/pmid33879890_Covid19 PBMC"
TAG = "33879890_Covid19_PBMC"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

####
#### upper here something wrong !!! ####
####


folder = "/zp1/data/plyu3/UCSC/pmid33958799_Airway Epithelium in CF Patients"
TAG = "33958799_Airway_Epithelium"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


folder = "/zp1/data/plyu3/UCSC/pmid34035279_Human fetal pancreas and spheroids/Fetal"
TAG = "34035279_Human_fetal_pancreas_Fetal"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)



folder = "/zp1/data/plyu3/UCSC/pmid34035279_Human fetal pancreas and spheroids/Combined"
TAG = "34035279_Human_fetal_pancreas_Combined"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)



folder = "/zp1/data/plyu3/UCSC/pmid34035279_Human fetal pancreas and spheroids/PP-spheroids"
TAG = "34035279_Human_fetal_pancreas_PP_spheroids"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)



folder = "/zp1/data/plyu3/UCSC/pmid34051145_Human Hippocampal Axis"
TAG = "34051145_Human_Hippocampal"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)



folder  = "/zp1/data/plyu3/UCSC/pmid34062119_multimodal PBMC"
TAG = "34062119_multimodal_PBMC"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)




folder = "/zp1/data/plyu3/UCSC/pmid34354210_Uninfected nasal mucosa across the lifespan"
TAG = "34354210_Uninfected_nasal"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)



#### red ########################
#### red ########################
#### something wrong !!!!! ######
#### red ########################
#### red ########################

folder = "/zp1/data/plyu3/UCSC/pmid34497389_Healthy human gut"
TAG = "34497389_Healthy_human_gut"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

####
#### upper here something wrong !!! ####
####



folder = "/zp1/data/plyu3/UCSC/pmid35232959_Human fetal liver HSC"
TAG = "35232959_Human_fetal_liver"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


folder = "/zp1/data/plyu3/UCSC/pmid35438006_Human bronchial epithelial cells/Submerged"
TAG = "35438006_Human_bronchial_Submerged"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


folder = "/zp1/data/plyu3/UCSC/pmid35438006_Human bronchial epithelial cells/ALI"
TAG = "35438006_Human_bronchial_ALI"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


folder = "/zp1/data/plyu3/UCSC/pmid35523173_Human Forebrain Development"
TAG = "35523173_Human_Forebrain"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


###### we will update the database_sheet ############
######
###### OK!!! we copy these files from batch3 ########
######
###### pink ######
###### pink ######
###### pink ######
###### pink ######
###### pink ######
###### pink ######
###### pink ######
######
source("/zp1/data/plyu3/UCSC/Prepare_CellAnn_DB_final_source.R")


we will create a new folder 

cd /zp1/data/plyu3

mkdir /zp1/data/plyu3/CellAnn_batch4

to = "/zp1/data/plyu3/CellAnn_batch4/"


#### Not work!!! #####
#### process this one !!! #######
#### too big !!!!! ##############

folder = "/zp1/data/plyu3/UCSC/pmid35549310_Developing human immune system"
setwd(folder)

mat = Broad_matrix_process("exprMatrix.tsv")

TAG = "35549310_Developing_human_immune"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


####

folder = "/zp1/data/plyu3/UCSC/pmid35549406_Pan-immune/B-cell"
TAG = "35549406_B_cell"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)



folder = "/zp1/data/plyu3/UCSC/pmid35549406_Pan-immune/Global"
TAG = "35549406_Pan_Global"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)



folder = "/zp1/data/plyu3/UCSC/pmid35549406_Pan-immune/Myeloid"
TAG = "35549406_Myeloid"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


folder = "/zp1/data/plyu3/UCSC/pmid35549406_Pan-immune/T-cell"
TAG = "35549406_T_cell"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#####

folder = "/zp1/data/plyu3/UCSC/pmid35820705_Alveolar Macrophage"
TAG = "35820705_Alveolar_Macrophage"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


###### no ? #######
######
######
folder = "/zp1/data/plyu3/UCSC/26430063_scRNA_Mouse Aging HSCs"
TAG = "26430063_Mouse_Aging_HSCs"
Read_Seurat_file_in_the_folder_UCSC(folder)


##### OK!!! to the old 1server 
##### OK!!! let us fill the datasets and go to the old server !!!! ########
#####
##### OK!!! let us process the other project !!! ##########################
#####

cd /home/plyu3/cell_ann_part_datasets1

mkdir pmid34642245_seurat_obj_folder
mv pmid34642245_seurat_obj pmid34642245_seurat_obj_folder/

to = "/zp1/data/plyu3/CellAnn_batch4/"


#### red #### at the new server ####
#### red ####
#### red ####


folder = "/home/plyu3/cell_ann_part_datasets1/pmid34642245_seurat_obj_folder"
TAG = "34642245"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#####
cd /home/plyu3/cell_ann_part_datasets1

mkdir pmid33444290_seurat_obj_folder
mv pmid33444290_seurat_obj pmid33444290_seurat_obj_folder/

folder = "/home/plyu3/cell_ann_part_datasets1/pmid33444290_seurat_obj_folder"
TAG = "33444290"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


#####

cd /home/plyu3/cell_ann_part_datasets1

mkdir pmid32994417_seurat_obj_folder
mv pmid32994417_seurat_obj pmid32994417_seurat_obj_folder/

folder = "/home/plyu3/cell_ann_part_datasets1/pmid32994417_seurat_obj_folder"
TAG = "32994417"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#####
conda activate seurat4
to = "/zp1/data/plyu3/CellAnn_batch4/"

mkdir pmid32427356_seurat_obj_folder 
mv pmid32427356_seurat_obj pmid32427356_seurat_obj_folder/

folder = "/home/plyu3/cell_ann_part_datasets1/pmid32427356_seurat_obj_folder"
TAG = "32427356"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#####

folder = "/home/plyu3/cell_ann_part_datasets1/34584087_scRNA_Human Ocular_Sclera and Choroid"
TAG = "34584087_scRNA_Human_Ocular_Scler"

setwd(folder)

######
Broad_matrix_process <- function(file,sep="\t"){
	matrix = read.table(file,header=T,sep=sep)
	mat_input = as.matrix(matrix[,-1])
	rownames(mat_input) = matrix[,1]
	print(mat_input[1:5,1:5])
	#######
	return(mat_input)
}

mat_input = Broad_matrix_process("Matrix.txt")


Broad_cluster_process <- function(file){
	#####
	cluster = read.table(file,header=T,sep="\t")
	cluster = cluster[-1,]
	#####
	print(head(cluster))
	#####
	return(cluster)
}

colnames(cluster) <- c('cell','dim1','dim2','phase','celltype')

########
Broad_create_seurat_obj <- function(mat_input,cluster,file){
	######
	library(Seurat)
	###### saveRDS #######
	seurat_obj = CreateSeuratObject(mat_input)
	######
	m = match(colnames(seurat_obj),cluster[,1])
	cluster = cluster[m,]
	######
	head(cluster)
	head(colnames(seurat_obj))
	######
	seurat_obj@meta.data = cbind(seurat_obj@meta.data,cluster)
	######
	k = which(colnames(seurat_obj@meta.data) %in% c("dim1","dim2","dim3") == T)
	if(length(k) > 0){
		for(j in k){
			seurat_obj@meta.data[,j] = as.numeric(seurat_obj@meta.data[,j])
		}
	}
	######
	saveRDS(seurat_obj,file=file)
}

Broad_create_seurat_obj(mat_input,cluster,file="pmid_34584087_seurat_obj")



folder = "/home/plyu3/cell_ann_part_datasets1/34584087_scRNA_Human Ocular_Sclera and Choroid"
TAG = "34584087_scRNA_Human_Ocular_Scler"

Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#####
############# OK!!!! ####################
#####

##### only one cell type !!!! ###########
#####
folder = "/home/plyu3/cell_ann_part_datasets1/34584087_scRNA_Human Ocular_RPE"
TAG = "34584087_scRNA_Human_Ocular_RPE"

setwd(folder)
mat_input = Broad_matrix_process("Matrix.txt")

cluster = Broad_cluster_process("Cluster.txt")
colnames(cluster) <- c('cell','dim1','dim2','phase','celltype')

Broad_create_seurat_obj(mat_input,cluster,file="pmid_34584087_RPE_seurat_obj")

Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")


######
folder = "/home/plyu3/cell_ann_part_datasets1/34584087_scRNA_Human Ocular_Retina"
TAG = "34584087_scRNA_Human_Ocular_Retina"

setwd(folder)
mat_input = Broad_matrix_process("Matrix.txt")
cluster = Broad_cluster_process("Cluster.txt")
colnames(cluster) <- c('cell','dim1','dim2','phase','celltype')

Broad_create_seurat_obj(mat_input,cluster,file="pmid_34584087_scRNA_Human_Ocular_Retina_seurat_obj")

Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


#######

folder = "/home/plyu3/cell_ann_part_datasets1/34584087_scRNA_Human Ocular_Iris"
TAG = "34584087_scRNA_Human_Ocular_Iris"

setwd(folder)
mat_input = Broad_matrix_process("Matrix.txt")
cluster = Broad_cluster_process("Cluster.txt")

k = which(colnames(mat_input) %in% cluster[,1] == T)
colnames(cluster) <- c('cell','dim1','dim2','phase','celltype')

Broad_create_seurat_obj(mat_input,cluster,file="pmid_34584087_scRNA_Human_Iris_seurat_obj")

Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


########
######## Next !!! ######

folder = "/home/plyu3/cell_ann_part_datasets1/34584087_scRNA_Human Ocular_Cornea"
TAG = "34584087_scRNA_Human_Ocular_Cornea"

setwd(folder)
mat_input = Broad_matrix_process("Matrix.txt")
cluster = Broad_cluster_process("Cluster.txt")
colnames(cluster) <- c('cell','dim1','dim2','phase','celltype')

Broad_create_seurat_obj(mat_input,cluster,file="pmid_34584087_scRNA_Human_Cornea_seurat_obj")

Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

######## Next !!! ######



######## 
######## No matrix !!!! #########
folder = "/home/plyu3/cell_ann_part_datasets1/33711272_scRNA_Human renal cell carcinoma"
TAG = "33711272_Human_renal_cell_carcinoma"
setwd(folder)
mat_input = Broad_matrix_process("Matrix.txt")
cluster = Broad_cluster_process("Cluster.txt")
colnames(cluster) <- c('cell','dim1','dim2','phase','celltype')


######## 
folder = "/home/plyu3/cell_ann_part_datasets1/33664492_scRNA_Human prostate cancer"
TAG = "33664492_scRNA_Human_prostate_cancer"
setwd(folder)
mat_input = Broad_matrix_process("Matrix.txt")
cluster = Broad_cluster_process("Cluster.txt")

####
cluster$NAME = paste0("X",cluster$NAME)
colnames(cluster) <- c('cell','celltype','celltype2','dim1','dim2')

Broad_create_seurat_obj(mat_input,cluster,file="pmid_333664492_scRNA_Human_prostate_seurat_obj")
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

###### red #################
###### No matrix !!! #######
######

folder = "/home/plyu3/cell_ann_part_datasets1/33619488_scRNA_Human_Covid19 Nasal Swab"
TAG = "33619488_Covid19_Nasal_Swab"
setwd(folder)
mat_input = Broad_matrix_process("Matrix.txt")
cluster = Broad_cluster_process("Cluster.txt")


######
folder = "/home/plyu3/cell_ann_part_datasets1/32413319_scRNA_Mouse Nasal mucosa after interferon"
TAG = "32413319_Mouse_Nasal_mucosa"
setwd(folder)
mat_input = Broad_matrix_process("Matrix.csv",sep=",")
cluster = Broad_cluster_process("Cluster.txt")

cluster = cluster[,c(6,12)]
colnames(cluster) <- c('cell','celltype')
######
###### modify the UMAPs for these samples #########
######

Broad_create_seurat_obj(mat_input,cluster,file="pmid_32413319_Mouse_Nasal_mucosa_seurat_obj")
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


######
###### we need modify the umaps bu our selfs #######
######

folder = "/home/plyu3/cell_ann_part_datasets1/32251406_scRNA_Human PBMC pre and post HIV"
TAG = "32251406_PBMC_HIV"
setwd(folder)
mat_input = Broad_matrix_process("Matrix.txt.gz")
cluster = Broad_cluster_process("Cluster.txt")

cluster = cluster[,c(1,8)]
colnames(cluster) <- c('cell','celltype')
Broad_create_seurat_obj(mat_input,cluster,file="pmid_32251406_PBMC_HIV_seurat_obj")

Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#######
####### yellow #######
#######

#######
####### OK!!! then the next !!!! #######
####### next we will start to batch5 !!! ######
#######

conda activate seurat4
to = "/zp1/data/plyu3/CellAnn_batch5/"

source("/zp1/data/plyu3/UCSC/Prepare_CellAnn_DB_final_source.R")



########## ok!!! #######
########## we start here !!! ######
folder = "/home/plyu3/cell_ann_part_datasets1/30526881_scRNA_Human Cultured Small intestinal organoids"
TAG = "30526881_Human_intestinal_organoids"
setwd(folder)


mat_input = Broad_matrix_process("Matrix.csv.gz",sep=",")
cluster = Broad_cluster_process("Cluster.csv",sep=',')

cluster = cluster[,c(1,4,2,3)]
colnames(cluster) <- c('cell','celltype','dim1','dim2')
Broad_create_seurat_obj(mat_input,cluster,file="30526881_Human_intestinal_organoids_seurat_obj")

Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

########### OK!!! next 2 ######
mkdir /zp1/data/plyu3/CellAnn_batch5/

mkdir /home/plyu3/cell_ann_part_datasets1/30382198_scRNA_Mouse_Neocortex_LGD
mkdir /home/plyu3/cell_ann_part_datasets1/30382198_scRNA_Mouse_Neocortex_ALM

cp /home/plyu3/cell_ann_part_datasets1/30382198_scRNA_Mouse_Neocortex/*LGd* /home/plyu3/cell_ann_part_datasets1/30382198_scRNA_Mouse_Neocortex_LGD/
cp /home/plyu3/cell_ann_part_datasets1/30382198_scRNA_Mouse_Neocortex/Matrix_lateral geniculate complex.txt /home/plyu3/cell_ann_part_datasets1/30382198_scRNA_Mouse_Neocortex_LGD/
cp /home/plyu3/cell_ann_part_datasets1/30382198_scRNA_Mouse_Neocortex/'Cluster_lateral geniculate complex.txt' /home/plyu3/cell_ann_part_datasets1/30382198_scRNA_Mouse_Neocortex_LGD/

cp 'Cluster_anterior lateral motor.txt' /home/plyu3/cell_ann_part_datasets1/30382198_scRNA_Mouse_Neocortex_ALM/
cp 'Matrix_anterior lateral motor.txt' /home/plyu3/cell_ann_part_datasets1/30382198_scRNA_Mouse_Neocortex_ALM/


folder = "/home/plyu3/cell_ann_part_datasets1/30382198_scRNA_Mouse_Neocortex_LGD"
TAG = "30382198_Mouse_Neocortex_LGD"
setwd(folder)


##### #####
mat_input = Broad_matrix_process("Matrix_lateral geniculate complex.txt",sep="\t")
colnames(mat_input) = gsub('.','-',colnames(mat_input),fixed=T)
cluster = Broad_cluster_process("Cluster_lateral geniculate complex.txt",sep='\t')
cluster = cluster[,c(1,2)]
colnames(cluster) <- c('cell','celltype')

k = which(colnames(mat_input) %in% cluster$cell == T)

Broad_create_seurat_obj(mat_input,cluster,file="330382198_Mouse_Neocortex_LGD_seurat_obj")

### tmp = readRDS("330382198_Mouse_Neocortex_LGD_seurat_obj")
input_folder = folder
Read_Seurat_file_in_the_folder_UCSC(folder)
### 
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)



###### seurat_obj <- readRDS('pmid30382198LGd_seurat_obj')

folder = "/home/plyu3/cell_ann_part_datasets1/30382198_scRNA_Mouse_Neocortex_ALM"
TAG = "30382198_Mouse_Neocortex_ALM"
setwd(folder)
mat_input = Broad_matrix_process("Matrix_anterior lateral motor.txt",sep=",")
colnames(mat_input) = gsub('.','-',colnames(mat_input),fixed=T)
cluster = Broad_cluster_process("Cluster_anterior lateral motor.txt",sep="\t")
cluster = cluster[,c(1,2)]
colnames(cluster) <- c('cell','celltype')
Broad_create_seurat_obj(mat_input,cluster,file="330382198_Mouse_Neocortex_ALM_seurat_obj")

Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")

input_folder = folder

Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

####### OK!!! #####
####### Next3 ######


folder = "/home/plyu3/cell_ann_part_datasets1/27806376_scRNA_Human Oligodendroglioma"
TAG = "27806376_Oligodendroglioma"
setwd(folder)
mat_input = Broad_matrix_process("Matrix.txt",sep="\t")
#colnames(mat_input) = gsub('.','-',colnames(mat_input),fixed=T)
cluster = Broad_cluster_process("Cluster.txt",sep="\t")
cluster = cluster[,c(1,2)]
colnames(cluster) <- c('cell','celltype')

Broad_create_seurat_obj(mat_input,cluster,file="27806376_Oligodendroglioma_seurat_obj")

Read_Seurat_file_in_the_folder_UCSC(folder)

Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


####### OK!!! #####
####### Next4 ######

folder = "/home/plyu3/cell_ann_part_datasets1/27565351_scRNA_Mouse Retinal Bipolar Neuron"
TAG = "27565351_Mouse_Retinal_Bipolar"
setwd(folder)
mat_input = Broad_matrix_process("Matrix.txt",sep="\t")
cluster = Broad_cluster_process("Cluster.txt",sep="\t")
cluster = cluster[,c(1,2)]
colnames(cluster) <- c('cell','celltype')

Broad_create_seurat_obj(mat_input,cluster,file="27565351_Mouse_Retinal_Bipolar_seurat_obj")

Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#######
####### Next5 ######
#######

folder = "/home/plyu3/cell_ann_part_datasets1/27471252_snRNA_Adult Mouse Hippocampus"
TAG = "27471252_Mouse_Hippocampus"
setwd(folder)
mat_input = Broad_matrix_process("Matrix.txt",sep="\t")
cluster = Broad_cluster_process("Cluster.txt",sep="\t")
cluster = cluster[,c(1,2)]
colnames(cluster) <- c('cell','celltype')
Broad_create_seurat_obj(mat_input,cluster,file="27471252_Mouse_Hippocampus_seurat_obj")

Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)



###### OK!!! #######
###### Next !!!!!###
######

folder = "/home/plyu3/cell_ann_part_datasets1/27124452_scRNA_Human Metastatic Melanoma"
TAG = "27124452_Mouse_Melanoma"
setwd(folder)
mat_input = Broad_matrix_process("Matrix.txt",sep="\t")
cluster = Broad_cluster_process("Cluster.txt",sep="\t")
cluster = cluster[,c(1,2)]
colnames(cluster) <- c('cell','celltype')
Broad_create_seurat_obj(mat_input,cluster,file="27124452_Mouse_Melanoma_seurat_obj")


Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

##### Next !!!!

folder = "/home/plyu3/cell_ann_part_datasets1/26727548_scRNA_Adult Mouse Visual Cortex"
TAG = "26727548_Mouse_Visual"
setwd(folder)
mat_input = Broad_matrix_process("Matrix.txt",sep="\t")
cluster = Broad_cluster_process("Cluster.txt",sep="\t")
cluster = cluster[,c(1,2)]
colnames(cluster) <- c('cell','celltype')
Broad_create_seurat_obj(mat_input,cluster,file="26727548_Mouse_Visual_seurat_obj")

Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

##### ######### ################ ##########
##### Next !!!!! don't need this !!!!! ####
folder = "/home/plyu3/cell_ann_part_datasets1/26430063_scRNA_Mouse Aging HSCs"
TAG = "26430063_Mouse_HSCs"
setwd(folder)

#####
##### Next !!!!! ########
#####

folder = "/home/plyu3/cell_ann_part_datasets1/33777933_bone_marrow"
TAG = "33777933_bone_marrow"
setwd(folder)

mat_input = Broad_matrix_process("counts.normalized.csv.gz",sep=",")
cluster = Broad_cluster_process("metadata.csv",sep=",")

tail(colnames(mat_input))
tail(cluster)
#####
cluster = cluster[,c(1,4,2,3)]
colnames(cluster) <- c('cell','celltype','dim1','dim2')
Broad_create_seurat_obj(mat_input,cluster,file="26430063_Mouse_HSCs_seurat_obj")
##### 
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)





######
folder = "/home/plyu3/cell_ann_part_datasets1/33619488_Human_Nasal_swabs"
TAG = "33619488_Human_Nasal_swabs"
setwd(folder)
###### OK!! then we start !! ######

file = "20210220_NasalSwab_RawCounts.txt"

##### ADD A \T AT THE START OF THE MATRIX #######
matrix = read_delim(file,delim="\t")

mat_input = Broad_matrix_process("20210220_NasalSwab_NormCounts.txt",sep="\t")
cluster = Broad_cluster_process("20210220_NasalSwab_UMAP.txt",sep="\t")

cluster = cluster[,c(1,4,2,3)]
colnames(cluster) <- c('cell','celltype','dim1','dim2')
Broad_create_seurat_obj(mat_input,cluster,file="26430063_Mouse_HSCs_seurat_obj")

Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


##### OK!!! next !!!! ######
#####
##### cd 31995762_total
mkdir /home/plyu3/cell_ann_part_datasets1/31995762_total
folder = "/home/plyu3/cell_ann_part_datasets1/31995762_total"
setwd(folder)


file = "PRJ0027145_ex.txt"
mat_input = Broad_matrix_process("PRJ0027145_ex.txt",sep="\t")
load('mat_input')

cluster = Broad_cluster_process("PRJ0027145_meta.txt",sep="\t")
table(cluster$Clusters_RPE)
table(cluster$Cell_type_full)

#### OK!!! let us use all first ######
####

dims = Broad_cluster_process("Clusters_full_tSNE.txt",sep=",")
m = match(dims$Clusters_full,cluster$Clusters_full)
dims$celltype = cluster$Cell_type_full[m]

dims = dims[,c(1,5,2,3)]
colnames(dims) <- c('cell','celltype','dim1','dim2')
Broad_create_seurat_obj(mat_input,dims,file="31995762_total_seurat_obj")

#### next: BC 
dims = Broad_cluster_process("Clusters_bipolar_tSNE.txt",sep=",")
m = match(dims$Clusters_bipolar,cluster$Clusters_bipolar)
dims$celltype = cluster$Cell_type_bipolar[m]
dims = dims[,c(1,5,2,3)]
colnames(dims) <- c('cell','celltype','dim1','dim2')

Broad_create_seurat_obj(mat_input,dims,file="31995762_BC_seurat_obj")

#### next: AC
dims = Broad_cluster_process("Clusters_amacrine_tSNE.txt",sep=",")
m = match(dims$Clusters_amacrine,cluster$Clusters_amacrine)
dims$celltype = cluster$Cell_type_amacrine[m]
dims = dims[,c(1,5,2,3)]
colnames(dims) <- c('cell','celltype','dim1','dim2')

Broad_create_seurat_obj(mat_input,dims,file="31995762_AC_seurat_obj")


#### RGC 
####

dims = Broad_cluster_process("Clusters_rgc_tSNE.txt",sep=",")
m = match(dims$Clusters_rgc,cluster$Clusters_rgc)
dims$celltype = cluster$Cell_type_rgc[m]
dims = dims[,c(1,5,2,3)]
colnames(dims) <- c('cell','celltype','dim1','dim2')

Broad_create_seurat_obj(mat_input,dims,file="31995762_RGC_seurat_obj")

#### HC
dims = Broad_cluster_process("Clusters_horizontal_tSNE.txt",sep=",")
m = match(dims$Clusters_horizontal,cluster$Clusters_horizontal)
dims$celltype = cluster$Cell_type_horizontal[m]
table(dims$celltype)
dims = dims[,c(1,5,2,3)]
colnames(dims) <- c('cell','celltype','dim1','dim2')
head(dims)
Broad_create_seurat_obj(mat_input,dims,file="31995762_HC_seurat_obj")


#### Cone
dims = Broad_cluster_process("Clusters_cones_tSNE.txt",sep=",")
m = match(dims$Clusters_cones,cluster$Clusters_cones)
dims$celltype = cluster$Cell_type_cones[m]
table(dims$celltype)
dims = dims[,c(1,5,2,3)]
colnames(dims) <- c('cell','celltype','dim1','dim2')
head(dims)
Broad_create_seurat_obj(mat_input,dims,file="31995762_Cone_seurat_obj")

#### 
dims = Broad_cluster_process("Clusters_myeloid_tSNE.txt",sep=",")
m = match(dims$Clusters_myeloid,cluster$Clusters_myeloid)
dims$celltype = cluster$Cell_type_myeloid[m]
table(dims$celltype)
dims = dims[,c(1,5,2,3)]
colnames(dims) <- c('cell','celltype','dim1','dim2')
head(dims)
Broad_create_seurat_obj(mat_input,dims,file="31995762_myeloid_seurat_obj")
####
#### OK!! create new folder !!! ####
####
mkdir /home/plyu3/cell_ann_part_datasets1/31995762_myeloid
mkdir /home/plyu3/cell_ann_part_datasets1/31995762_Cone
mkdir /home/plyu3/cell_ann_part_datasets1/31995762_HC
mkdir /home/plyu3/cell_ann_part_datasets1/31995762_RGC
mkdir /home/plyu3/cell_ann_part_datasets1/31995762_AC
mkdir /home/plyu3/cell_ann_part_datasets1/31995762_BC

cd /home/plyu3/cell_ann_part_datasets1/31995762_total
mv 31995762_AC_seurat_obj  /home/plyu3/cell_ann_part_datasets1/31995762_AC/
mv 31995762_BC_seurat_obj  /home/plyu3/cell_ann_part_datasets1/31995762_BC/
mv 31995762_HC_seurat_obj  /home/plyu3/cell_ann_part_datasets1/31995762_HC/

mv 31995762_myeloid_seurat_obj  /home/plyu3/cell_ann_part_datasets1/31995762_myeloid/
mv 31995762_RGC_seurat_obj  /home/plyu3/cell_ann_part_datasets1/31995762_RGC/
mv 31995762_Cone_seurat_obj  /home/plyu3/cell_ann_part_datasets1/31995762_Cone/

#### 8 !!! ##

folder = '/home/plyu3/cell_ann_part_datasets1/31995762_total'
TAG = '31995762_total'
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

folder = '/home/plyu3/cell_ann_part_datasets1/31995762_AC'
TAG = '31995762_AC'
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

folder = '/home/plyu3/cell_ann_part_datasets1/31995762_BC'
TAG = '31995762_BC'
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

folder = '/home/plyu3/cell_ann_part_datasets1/31995762_Cone'
TAG = '31995762_Cone'
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


folder = '/home/plyu3/cell_ann_part_datasets1/31995762_HC'
TAG = '31995762_HC'
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


folder = '/home/plyu3/cell_ann_part_datasets1/31995762_myeloid'
TAG = '31995762_myeloid'
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

folder = '/home/plyu3/cell_ann_part_datasets1/31995762_RGC'
TAG = '31995762_RGC'
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


####
#### OK!!! next !!!! ########
Cell Atlas of The Human Fovea and Peripheral Retina
mkdir 32555229_Human_Fovea_Peripheral

folder = "/home/plyu3/cell_ann_part_datasets1/32555229_Human_Fovea_Peripheral"
TAG = "32555229_Human_Fovea_Peripheral"
setwd(folder)

mat_input = Broad_matrix_process("Human_retina_combined_all_expression_matrix.csv",sep=",")
cluster = Broad_cluster_process("Human_retina_combined_all_meta.csv",sep=",")

####

tail(colnames(mat_input))
tail(cluster)
#####
cluster = cluster[,c(1,2)]
colnames(cluster) <- c('cell','celltype')
Broad_create_seurat_obj(mat_input,cluster,file="32555229_Human_Fovea_Peripheral_seurat_obj")
##### 
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)





#### OK!!! next !!!! ########
#### Single-Cell Analysis of Human Retina Identifies Evolutionarily Conserved and Species-Specific Mechanisms Controlling Development
Single cell RNA sequencing of human liver reveals distinct intrahepatic macrophage populations
mkdir 30348985_human_liver


folder = "/home/plyu3/cell_ann_part_datasets1/30348985_human_liver"
TAG = "30348985_human_liver"
setwd(folder)

mat_input = Broad_matrix_process("GSE115469_Data.csv",sep=",")
cluster = Broad_cluster_process("GSE115469_CellClusterType.txt",sep="\t")

tail(colnames(mat_input))
tail(cluster)
#####
cluster = cluster[,c(1,5)]
#colnames(cluster) <- c('cell','celltype','dim1','dim2')
colnames(cluster) <- c('cell','celltype')

Broad_create_seurat_obj(mat_input,cluster,file="30348985_human_liver_seurat_obj")
##### 
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log2")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)














####
#### OK!!! next !!!! ########
#### 
A human liver cell atlas reveals heterogeneity and epithelial progenitors
PMID: 31292543

nohup curl -o local.rds "https://corpora-data-prod.s3.amazonaws.com/0b139068-19fc-4b70-a235-dcd0bdbb11e9/local.rds?AWSAccessKeyId=ASIATLYQ5N5XY3VU2LUX&Signature=AxfAr7I8bj%2Fx8zZW3MK8vGy3ESU%3D&x-amz-security-token=IQoJb3JpZ2luX2VjEAoaCXVzLXdlc3QtMiJHMEUCIHgUBB9E7GN5RcPdojPIAbgdBfqxwnYkoGvnQ0Q0eEXNAiEA4fp1xv0up2DSf3sKLjEeopyRv1s%2Ft4jbAPVInpOEvMwq9AMIg%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARABGgwyMzE0MjY4NDY1NzUiDELRTonoTbDsCL6jfCrIAxQbD57FnPco2vffrlf32kb6Uk3zMzn5sg%2B0LIR1v4t3GpTRbRORGkhhUJgdlEcjAi0K3IyXuSgon%2BIw16qI3UlcGnEpfM384%2B2SPHG5e3Lt30HEZPrLZnbUk4gV%2BhmsrCzqnTtqsJsYL17B5ye8mwYUTwqznllGPUspbA5gRw8CRCUpW2V%2FsU%2Be0Pj71DnbUF4lgUAD5pt3JSP%2F%2Fl6MtMX9fklfkh8hWigi6vltmue%2F4ztzDltIQB1kXGx%2FituN1zAhjYtMuI5tQLIc9Vc7B1tdTiEq5WYIt0TYeB%2BTVSbdoBdWooRu5YToa%2BG9zrTtbiC3fK8Zq5jhSJUEsaMIuU7X2EyMqJpGz1lBmqnkS%2B7jewqSdmY4PU085DMjdoF0eBtNQvTix5HOwKdLv8uY8KOJ6MKDoimyNgg3Nu11DxdOoOCDYCf7IYpjkERgaUCaXkUjXQ1FFyo64eIW0UWh6%2B8trMKT2v%2B6aLkFcUDeC%2FC3%2FcZW5CUfcUcUZSu32TzPB7lH9jaKm61Xq16%2FoS1BMyn20crB%2F8hC%2B4b11URC6tOsE%2FcmfuRZlCCrjOCpF5bnxt7PwyN4wi%2BFzHxq73RlKowovPZYc9z2BTDIw9yeBjqlATxT0CCJaxBZ8hLAuPfXLK6w%2Bud1B%2BwQsIJrT8hL%2B23UqE5FKqqtEZ5RxpDH77xZhRDlkFOlofAMOElK6Jzkbw6PEvHNimxAiBZScs8NDLAp1veCYJ9wJ5tf2s4j1g8tkRGbxVHjFS7BE8wX7Vl4%2FJI2dUOxrUk0Fb%2FP5wUDIWl5QdLPvcVPDjH7MKMfYNuIsiuEB5GCUH%2BZzFhE1%2BUNwuojF0JFzQ%3D%3D&Expires=1675649827" &

#### OK!!! next !!!! ##########
Mapping the developing human immune system across organs
PMID: 35549310

mkdir 35549310_human_immune_system
cd 35549310_human_immune_system
nohup curl -o local.rds "https://corpora-data-prod.s3.amazonaws.com/a7a1aa72-a6ea-4044-9e50-c32b0ca5cbb6/local.rds?AWSAccessKeyId=ASIATLYQ5N5XY3VU2LUX&Signature=EUcEZvDuxrmQo10D3L%2BEMVveBC0%3D&x-amz-security-token=IQoJb3JpZ2luX2VjEAoaCXVzLXdlc3QtMiJHMEUCIHgUBB9E7GN5RcPdojPIAbgdBfqxwnYkoGvnQ0Q0eEXNAiEA4fp1xv0up2DSf3sKLjEeopyRv1s%2Ft4jbAPVInpOEvMwq9AMIg%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARABGgwyMzE0MjY4NDY1NzUiDELRTonoTbDsCL6jfCrIAxQbD57FnPco2vffrlf32kb6Uk3zMzn5sg%2B0LIR1v4t3GpTRbRORGkhhUJgdlEcjAi0K3IyXuSgon%2BIw16qI3UlcGnEpfM384%2B2SPHG5e3Lt30HEZPrLZnbUk4gV%2BhmsrCzqnTtqsJsYL17B5ye8mwYUTwqznllGPUspbA5gRw8CRCUpW2V%2FsU%2Be0Pj71DnbUF4lgUAD5pt3JSP%2F%2Fl6MtMX9fklfkh8hWigi6vltmue%2F4ztzDltIQB1kXGx%2FituN1zAhjYtMuI5tQLIc9Vc7B1tdTiEq5WYIt0TYeB%2BTVSbdoBdWooRu5YToa%2BG9zrTtbiC3fK8Zq5jhSJUEsaMIuU7X2EyMqJpGz1lBmqnkS%2B7jewqSdmY4PU085DMjdoF0eBtNQvTix5HOwKdLv8uY8KOJ6MKDoimyNgg3Nu11DxdOoOCDYCf7IYpjkERgaUCaXkUjXQ1FFyo64eIW0UWh6%2B8trMKT2v%2B6aLkFcUDeC%2FC3%2FcZW5CUfcUcUZSu32TzPB7lH9jaKm61Xq16%2FoS1BMyn20crB%2F8hC%2B4b11URC6tOsE%2FcmfuRZlCCrjOCpF5bnxt7PwyN4wi%2BFzHxq73RlKowovPZYc9z2BTDIw9yeBjqlATxT0CCJaxBZ8hLAuPfXLK6w%2Bud1B%2BwQsIJrT8hL%2B23UqE5FKqqtEZ5RxpDH77xZhRDlkFOlofAMOElK6Jzkbw6PEvHNimxAiBZScs8NDLAp1veCYJ9wJ5tf2s4j1g8tkRGbxVHjFS7BE8wX7Vl4%2FJI2dUOxrUk0Fb%2FP5wUDIWl5QdLPvcVPDjH7MKMfYNuIsiuEB5GCUH%2BZzFhE1%2BUNwuojF0JFzQ%3D%3D&Expires=1675650212" &

#### OK!!! next !!!! ##########





#### OK!!! next !!!! #######
####
A cell atlas of human thymic development defines T cell repertoire formation
PMID: 32079746

mkdir 32079746_human_thymic
cd 32079746_human_thymic
curl -o local.rds "https://corpora-data-prod.s3.amazonaws.com/0b139068-19fc-4b70-a235-dcd0bdbb11e9/local.rds?AWSAccessKeyId=ASIATLYQ5N5XWRWFR6PE&Signature=0NY7CJt2XfXpDR4McPoJJKtwIuo%3D&x-amz-security-token=IQoJb3JpZ2luX2VjEAoaCXVzLXdlc3QtMiJGMEQCIECHA981gvQycoTP%2BN9ttLpE67HayMM6H1ZwKTk92yMZAiBlO3hwsHDno8gVAUej%2BBY1%2BfaLpgxgy%2FwClh5Q6tkCQCr0AwiD%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAEaDDIzMTQyNjg0NjU3NSIMyT7T7fGtwfLcz880KsgDowIxOonbHl81qDlGlINZArD1gAMjCPjqIRE5fats4rhwZeI175lSdTI1pDR5EtciJYikcLPg09h%2BRJPOX9amQ3r2V%2BGd%2FmXj8YBU5XzKbie2JHCGELcxysznKmmIcXvmuRcGaOG1MY22Y%2Btj5Zsv5Hw%2Bx%2B4gU5XIxo5VKTOWctjgXMdiTIgeIyWbIUIocqTY%2BHt8mcNpt3AXX96K0ktCsno6DjWjXE%2Ff2IFyj5jtYRnhrlH%2FYb9NGKehjuMhZz0QruCfARY4hztzkMmghlk%2Fjvexhh8DvuXNU2Os2r4jMOC3nigiuUMc9schprxfW1l72pARm%2FqLy0%2FIb4NLQppD6n%2F3CUTcytvS%2Bsj9416c3rtXlAnKuzet9Hr6B%2F3nPghMfY1qsKcRAsYMMdDFgL%2BFznUfrkuUkqDdkZDDxOTR%2B923jGpBfMaIlOuXZWfUti6v7PIL8G89m7OWOAXQzJH%2FiuPoGbxTSTYJkUfUpBJ0B3QClM1KC3ddBL4jxkt%2Fgpg%2FXPfz9d6rZWvDMQQFtWV5a2glFdnFLSZz4hq0dYnw4yGzaHwDgJNwNORTaQ%2F23VsW9Y1LoH6QqaHmxpPK%2FFu7zLj2DbtxXU0wML653J4GOqYBH%2BMFTlI5E%2FCWF2hwYiM9arFzDW513HwTYD4qWCswogZ05db6I4KZXW%2BH0Wz6%2BbNwq21ON5EF%2FP0ENyhskUzC4FpsqmGIMQ6jLgYZelpgxIcsGXuFjotMXSBnDPOwoQuRVgJHy33n4DHIDSbJTl5Fu7b%2BZqVSknJ68ftMhLAHB8eJTXKnz32yOBFpzilKHSrovr0CofVl5Ncyvwl1uLAurCRNvFHcBQ%3D%3D&Expires=1675649670"








####
####
#### OK!!! then we will found the next thing ########
####


scp -r /zp1/data/yzhai11/UCSC plyu3@omb2.onc.jhmi.edu:/zp1/data/plyu3/UCSC_old

mkdir /zp1/data/plyu3/CellAnn_batch6/

conda activate seurat4

to = "/zp1/data/plyu3/CellAnn_batch6/"

source("/zp1/data/plyu3/UCSC/Prepare_CellAnn_DB_final_source.R")
source("/zp1/data/plyu3/UCSC/Prepare_CellAnn_DB_final_add1.R")

setwd('/zp1/data/plyu3/UCSC_old')

##### No.1 #####
#####
to = "/zp1/data/plyu3/CellAnn_batch6/"

##### ################## #####

##### red ######
##### red ######


folder = "/zp1/data/plyu3/UCSC_old/pmid23193282Cortex"
TAG = "23193282Cortex_Human"

##### ################## #####
Read_Seurat_file_in_the_folder_UCSC(folder)
#####
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#####
##### red ######
#####

folder = "/zp1/data/plyu3/UCSC_old/pmid23193282Motor"
TAG = "23193282Motor"

Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

##################
##### red ######
##################

folder = "/zp1/data/plyu3/UCSC_old/pmid28965763"
TAG = "28965763_Human_Pancreas"

input_folder = folder
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log2")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)



#### red #####



folder = "/zp1/data/plyu3/UCSC_old/pmid30315278"
TAG = "28965763_Human_testis"

input_folder = folder
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


#### red #####

folder = "/zp1/data/plyu3/UCSC_old/pmid30348985"
TAG = "30348985_Human_Liver"

input_folder = folder
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log2")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


#### red #####

folder = "/zp1/data/plyu3/UCSC_old/pmid30355494"
TAG = "30355494_Human_Skin"

input_folder = folder
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


#### red #####

folder = "/zp1/data/plyu3/UCSC_old/pmid30429548"
TAG = "30355494_Human_Reproductive_system"

input_folder = folder
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


#### red #####

folder = "/zp1/data/plyu3/UCSC_old/pmid30566875"
TAG = "30566875_Human_Prostate"

input_folder = folder
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)

Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#####
##### ####### ######
##### 4 #####
#####

folder = "/zp1/data/plyu3/UCSC_old/pmid30726734"
TAG = "30726734_Human_testis"
#####
##### # #####
#####

input_folder = folder
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#### 1 ######
folder = "/zp1/data/plyu3/UCSC_old/pmid30747918"
TAG = "30747918_Human_white_matter"

Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#### 3 ######
folder = "/zp1/data/plyu3/UCSC_old/pmid31075224"
TAG = "31075224_Human_eye"

Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


#### 4 ######

folder = "/zp1/data/plyu3/UCSC_old/pmid31209336bronchi"
TAG = "31075224_Human_Lung_bronchi"

setwd(folder)

Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


##### 1 #####


folder = "/zp1/data/plyu3/UCSC_old/pmid31209336epithelial"
TAG = "31075224_Human_Lung_epithelial"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


##### 3 #####


folder = "/zp1/data/plyu3/UCSC_old/pmid31209336nasal"
TAG = "31075224_Human_Lung_nasal"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

##### 4 #####

folder = "/zp1/data/plyu3/UCSC_old/pmid31209336parenchyma"
TAG = "31075224_Human_Lung_parenchyma"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


##### 3 ######


folder = "/zp1/data/plyu3/UCSC_old/pmid31316211"
TAG = "31075224_Human_Brain"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log2")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


##### 4 ##

folder = "/zp1/data/plyu3/UCSC_old/pmid31341279"
TAG = "31341279_Mouse_Heart"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log2")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#### 1 ###

folder = "/zp1/data/plyu3/UCSC_old/pmid31436334"
TAG = "31436334_Human_eye"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#### 5 ###


folder = "/zp1/data/plyu3/UCSC_old/pmid31474370"
TAG = "31474370_Human_Intestine"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#### 4 ####

folder = "/zp1/data/plyu3/UCSC_old/pmid31604275Fetal"
TAG = "31604275_Human_Fetal_kidney"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#### 1 ####

folder = "/zp1/data/plyu3/UCSC_old/pmid31604275Mature"
TAG = "31604275_Human_Mature_kidney"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#### 6 #####

folder = "/zp1/data/plyu3/UCSC_old/pmid31712411"
TAG = "31712411_Human_Eye"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


#### 5 ######
folder = "/zp1/data/plyu3/UCSC_old/pmid31753849Colon"
TAG = "31753849Colon"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#### 5 ####
folder = "/zp1/data/plyu3/UCSC_old/pmid31753849Ileum"
TAG = "31753849Ileum"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#### 5 ###
folder = "/zp1/data/plyu3/UCSC_old/pmid31753849Rectum"
TAG = "31753849Rectum"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#### 1 ###
folder = "/zp1/data/plyu3/UCSC_old/pmid32066951"
TAG = "32066951_Human_Intestine"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


#### 2 ###
folder = "/zp1/data/plyu3/UCSC_old/pmid32109386"
TAG = "32109386_Human_Lung"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

### 3 ###

folder = "/zp1/data/plyu3/UCSC_old/pmid32123174"
TAG = "32123174_Human_ovarian"

Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

### 4 ###
folder = "/zp1/data/plyu3/UCSC_old/pmid32327715"
TAG = "32327715_Human_skin"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#########
### 1 ###
#########
folder = "/zp1/data/plyu3/UCSC_old/pmid32396864Adult"
TAG = "32396864_Human_Muscle"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#########
#########
### 2 ###
#########

folder = "/zp1/data/plyu3/UCSC_old/pmid32396864Embryonic"
TAG = "32396864_Human_Embryonic_Hindlimb_Muscle"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


##########
### 1 ####
##########

folder = "/zp1/data/plyu3/UCSC_old/pmid32396864Fetal"
TAG = "32396864_Human_Fetal_Hindlimb_Muscle"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


#### 2 ###
folder = "/zp1/data/plyu3/UCSC_old/pmid32396864Juvenile"
TAG = "32396864_Human_Juvenile_Hindlimb_Muscle"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


#### 3 ###
folder = "/zp1/data/plyu3/UCSC_old/pmid32499656"
TAG = "32499656_human_blood"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#### 4 ###
folder = "/zp1/data/plyu3/UCSC_old/pmid32514174"
TAG = "32514174_human_PBMC"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#### 5 ####
folder = "/zp1/data/plyu3/UCSC_old/pmid32527923"
TAG = "32527923_human_Brain"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#### 1 ######
folder = "/zp1/data/plyu3/UCSC_old/pmid32624006"
TAG = "32624006_human_Muscle"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


#### 2 ####
folder = "/zp1/data/plyu3/UCSC_old/pmid32651212"
TAG = "32651212_Human_Blood"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log2")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


#### 3 ####

folder = "/zp1/data/plyu3/UCSC_old/pmid32728211"
TAG = "32728211_Mouse_skin"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


#### 3 ####

folder = "/zp1/data/plyu3/UCSC_old/pmid32887883"
TAG = "32887883_Mouse_Brain"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#### 1 #####

folder = "/zp1/data/plyu3/UCSC_old/pmid33321047ASE"
TAG = "33321047ASE"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


#### 4 ######
folder = "/zp1/data/plyu3/UCSC_old/pmid33321047ASE"
TAG = "33321047SLAE"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)



#### 5 ###
folder = "/zp1/data/plyu3/UCSC_old/pmid33448928"
TAG = "33448928_Mouse_Kidney"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


#### 1 #####
folder = "/zp1/data/plyu3/UCSC_old/pmid33730024"
TAG = "33730024_Human_airway"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#### 4 #####

folder = "/zp1/data/plyu3/UCSC_old/pmid33850129"
TAG = "33850129_Human_kidney"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

### 5 #####
folder = "/zp1/data/plyu3/UCSC_old/pmid33958799"
TAG = "33958799_Human_airway"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

### 3 #####
folder = "/zp1/data/plyu3/UCSC_old/pmid34004146"
TAG = "34004146_Mouse_Brain"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

### 4 ######
folder = "/zp1/data/plyu3/UCSC_old/pmid34494546"
TAG = "34494546_Mouse_Brain"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

### 
### 1 ######
###

folder = "/zp1/data/plyu3/UCSC_old/pmid34497421"
TAG = "34497421_Human_Brain"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


###
### 2 ######
###
folder = "/zp1/data/plyu3/UCSC_old/pmid34616070Neocortex"
TAG = "34616070_Neocortex"
Read_Seurat_file_in_the_folder_UCSC(folder)

###
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

### 4 ######
folder = "/zp1/data/plyu3/UCSC_old/pmid35093191"
TAG = "35093191_Human_Brain"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

###
### 5 ######
###
folder = "/zp1/data/plyu3/UCSC_old/pmid35165441"
TAG = "35165441_Human_Brain"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)



###
### OK!!! next is the SCP datasets !!! ########
###


###
### this is not on the UCSC_old folder !!! #####
###

to = "/zp1/data/plyu3/CellAnn_batch8/"



#### batch 1 ###

folder = "/zp1/data/plyu3/SCP_old/pmid28428369"
TAG = "28428369_Human_Blood"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


#### batch 2 ###
mkdir pmid30382198ALM
mv  pmid30382198ALM_seurat_obj pmid30382198ALM/pmid30382198ALM_seurat_obj

folder = "/zp1/data/plyu3/SCP_old/pmid30382198ALM"
TAG = "30382198_Mouse_Brain"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


#### batch 3 ###
mkdir /zp1/data/plyu3/SCP_old/pmid30382198LGd
mv  pmid30382198LGd_seurat_obj pmid30382198LGd/pmid30382198LGd_seurat_obj

folder = "/zp1/data/plyu3/SCP_old/pmid30382198LGd"
TAG = "30382198_Mouse_Brain_LGd"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#### batch 4 ###
mkdir /zp1/data/plyu3/SCP_old/pmid32413319
mv  pmid32413319_seurat_obj pmid32413319/pmid32413319_seurat_obj

folder = "/zp1/data/plyu3/SCP_old/pmid32413319"
TAG = "32413319_Human_Airway"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


####
#### batch5 #####
#### pmid32427356_seurat_obj

mkdir "/zp1/data/plyu3/SCP_old/pmid32427356"
mv pmid32427356_seurat_obj pmid32427356/pmid32427356_seurat_obj

folder = "/zp1/data/plyu3/SCP_old/pmid32427356"
TAG = "32427356_Mouse_Bone"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


#### batch6 #####
#### pmid32555229
mkdir /zp1/data/plyu3/SCP_old/pmid32555229_AC
mkdir /zp1/data/plyu3/SCP_old/pmid32555229_BP
mkdir /zp1/data/plyu3/SCP_old/pmid32555229_HC
mkdir /zp1/data/plyu3/SCP_old/pmid32555229_NN
mkdir /zp1/data/plyu3/SCP_old/pmid32555229_PR
mkdir /zp1/data/plyu3/SCP_old/pmid32555229_RGC

cd /zp1/data/plyu3/SCP_old/pmid32555229

folder = "/zp1/data/plyu3/SCP_old/pmid32555229_AC"
TAG = "32555229_Human_eye_AC"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log2")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


#### batch 1 ####
folder = "/zp1/data/plyu3/SCP_old/pmid32555229_BP"
TAG = "32555229_Human_eye_BP"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log2")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#### batch 2 ####
folder = "/zp1/data/plyu3/SCP_old/pmid32555229_HC"
TAG = "32555229_Human_eye_HC"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log2")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#### batch 3 ####
folder = "/zp1/data/plyu3/SCP_old/pmid32555229_NN"
TAG = "32555229_Human_eye_NN"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log2")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#### batch 4 ####
folder = "/zp1/data/plyu3/SCP_old/pmid32555229_PR"
TAG = "32555229_Human_eye_PR"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log2")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#### batch 5 ####
folder = "/zp1/data/plyu3/SCP_old/pmid32555229_RGC"
TAG = "32555229_Human_eye_RGC"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log2")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#### batch6 ######

mkdir "/zp1/data/plyu3/SCP_old/pmid32994417"
mv pmid32994417_seurat_obj pmid32994417/pmid32994417_seurat_obj

folder = "/zp1/data/plyu3/SCP_old/pmid32994417"
TAG = "32994417_Mouse_Brain"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


### batch7 ####

mkdir "/zp1/data/plyu3/SCP_old/pmid33444290"
mv pmid33444290_seurat_obj pmid33444290/pmid33444290_seurat_obj

folder = "/zp1/data/plyu3/SCP_old/pmid33444290"
TAG = "32994417_Mouse_Kidney"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


### batch1 #####
folder = "/zp1/data/plyu3/SCP_old/pmid33655247Heart"
TAG = "33655247_Human_Heart"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log2")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


### batch2 #####
folder = "/zp1/data/plyu3/SCP_old/pmid33655247Kidney"
TAG = "33655247_Human_Kidney"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log2")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


### batch3 #####
folder = "/zp1/data/plyu3/SCP_old/pmid33655247Liver"
TAG = "33655247_Human_Liver"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

### batch4 #####
folder = "/zp1/data/plyu3/SCP_old/pmid33655247Lung"
TAG = "33655247_Human_Lung"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

### batch5 #####
folder = "/zp1/data/plyu3/SCP_old/pmid34616064adult"
TAG = "34616064_Mouse_brain_adult"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


### batch6 #####
folder = "/zp1/data/plyu3/SCP_old/pmid34616064dev"
TAG = "34616064_Mouse_brain_dev"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

### batch2 #####
mkdir "/zp1/data/plyu3/SCP_old/pmid34642245"
mv pmid34642245_seurat_obj pmid34642245/pmid34642245_seurat_obj

folder = "/zp1/data/plyu3/SCP_old/pmid34642245"
TAG = "34642245_Mouse_Blood"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#### batch3 #####
folder = "/zp1/data/plyu3/SCP_old/pmid35241836"
TAG = "35241836_Human_Pancreas"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#### batch6 #####
folder = "/zp1/data/plyu3/SCP_old/pmid35296864Hs"
TAG = "35296864_Human_Adipose"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)


#### batch1 #####
folder = "/zp1/data/plyu3/SCP_old/pmid35296864Mm"
TAG = "35296864_Mouse_Adipose"
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="log")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)




###
### blue download mouse eye datasets #######
###

scp -r /zp1/data/yzhai11/SCPData plyu3@omb2.onc.jhmi.edu:/zp1/data/plyu3/SCP_old

### Next we download a new retina datasets ####
mkdir /zp1/data/plyu3/Eye_add_CellAnn
Single cell RNA-Seq atlas of the developing murine retina
PMID: 31128945
mkdir /zp1/data/plyu3/Eye_add_CellAnn/31128945_Mouse_dev_retina


### ##### ###
### OK!!! ###
### ##### ###




###
###
### batch7 #####
###
folder = "/zp1/data/plyu3/Eye_add_CellAnn/31128945_Mouse_dev_retina"
setwd(folder)
files = list.files()
mat = Matrix::readMM("10x_mouse_retina_development.mtx")
cols = read.table(files[3],header=T,sep=',')
genes = read.table(files[1],header=T,sep=',')

rownames(mat) = genes$gene_short_name
colnames(mat) = cols$barcode

cluster = cols[,c(2,94,9,10,11)]
colnames(cluster) = c()

colnames(cluster) <- c('cell','celltype','dim1','dim2','dim3')
Broad_create_seurat_obj(mat,cluster,file="31128945_Mouse_dev_retina_seurat_obj")
##### 

TAG = "31128945_Mouse_dev_retina"

Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)



#####
##### Then next paper !!! ######
#####
#####
##### Jie's science paper !!! #######
#####
Gene regulatory networks controlling vertebrate retinal regeneration

PMID: 33004674
mkdir /zp1/data/plyu3/Eye_add_CellAnn/33004674_Mouse_injury_retina

##### 
##### prepare !!! #######
#####

##### batch7 ############
#####
folder = "/zp1/data/plyu3/Eye_add_CellAnn/33004674_Mouse_injury_retina"
setwd(folder)
load('Mouse_LD_pbmc_seurat.RData')

#####
Mouse_LD_pbmc_seurat <- UpdateSeuratObject(pbmc)

matrix_input = Mouse_LD_pbmc_seurat[['RNA']]@counts

#####
cluster = read.table('Mouse_LD_cell_features.tsv',header=F,sep='\t')
cluster = cluster[,c(1,3,4,5)]
colnames(cluster) <- c('cell','celltype','dim1','dim2')

##### replace with gene symbol #####
#####
gene = read.table('Mouse_gene_features.tsv',sep='\t')

m = match(rownames(matrix_input),gene$V1)
rownames(matrix_input) = gene$V2[m]

TAG = "33004674_Mouse_injury_retina"

Broad_create_seurat_obj(matrix_input,cluster,file="33004674_Mouse_injury_retina_seurat_obj")
Read_Seurat_file_in_the_folder_UCSC(folder)
Prepare_Seurat_file_in_the_folder_UCSC(folder,norm="counts")
Prepare_Seurat_file_in_the_folder_UCSC_STEP2(folder)
Prepare_Seurat_file_in_the_folder_UCSC_STEP2_copy_folder(folder,to,TAG)

#######
####### OK!!! Next retina reference !! #########
#######

Cell-Type-Specific Complement Expression in the
Healthy and Diseased Retina

GSE116426


#######
Phase transition specified by a binary code patterns the vertebrate eye cup


#######
Single-cell transcriptomics of the human retinal pigment epithelium and choroid in health and macular degeneration





#######
The Tabula Sapiens: A multiple-organ, single-cell transcriptomic atlas of humans
#######
####### CellXGene website ########
#######
mkdir /zp1/data/plyu3/Altas_add_CellAnn
mkdir /zp1/data/plyu3/Altas_add_CellAnn/Tabula_Sapiens_combine

cd /zp1/data/plyu3/Altas_add_CellAnn/Tabula_Sapiens_combine

nohup curl -o local.rds "https://corpora-data-prod.s3.amazonaws.com/fab1d235-d9fe-4028-81db-029983860486/local.rds?AWSAccessKeyId=ASIATLYQ5N5XTF2IWXFA&Signature=7CYOdect5EzJmO3qvwlST2yYado%3D&x-amz-security-token=IQoJb3JpZ2luX2VjEFAaCXVzLXdlc3QtMiJHMEUCIQCHc%2ByB9tr%2Bk%2FzGGcqdvBzCWmn6Vpw%2BLzvvoBa%2FYARL9wIgSk5bw3Ag1pxHkWlUdYTiWemnKb02QbAnvwxBdS5QaWsq9AMIyf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARABGgwyMzE0MjY4NDY1NzUiDAIPGlX2F2Aw%2BSABIirIA8o3LqwUbKtFvYuZTk8QFl1r52JelIeKpyXncTgFrClTrH%2FFIL07t2xUq4%2FnlSBQ9swk0SGQP%2BWajjagebV%2Ba3MLbIweiF0frL8mtbfDro%2BFHbPXxnxvll%2Fu7xBgTt3uOwW1NmRe13hZJyttJFC%2FuXSiSyU0kvmW2RpoMWfaj4GV5pUbF%2FAAYNM2FWAsZNBQniv82S4un3DVdNkCzCcoFSFNRFqq8hZQOfS9GxGMQwOc%2B1%2F%2FkxGddmTIJDpGox%2FL8j5c9SkJTFFaUSfflLSM29RSUrAAPtt3aMnoH6ZGmoHIN4DcU5Yqhbf4mSQ1Wjldxdnzr8%2Fs64M9C8P2nzy7GR5l2QDEcTQFLWFm4xaQCC2xOJ6EfbgdlpQWUuVLhneoj6UhJtxOXT71lchc9%2FRQafdYLlBvGdDwznnfBp7Sj4ctADYSS3PwLUxdXYA6cpEbxQh3MRWR0TckO1foNOgJO8DAdyBuiMVVNRnQgnFqnQOUVzrUCGtC%2FPjt1ipOmLnJeOjOdU%2BrrkoS2B5r8fvZBjoBK1jbtGL7JicCMwqwtGXD0XVL5CxOyi1N6Ianob7K5l0sVw9k8S%2ForfxJ7HHqysUxtZUniAcdljDG6uueBjqlAVcFDw2P%2F50COUtAly%2BX0sQ%2B7xX34Dr4zuB773IvPfmpSrFNtQ1%2BrGQW09t4xBcg4zWlGNnX18uyMbUZjwlUDen2PeRVRP8NzXaDYdrOhGqnuoaUDxwmqHoOAHG3TQpUG3%2FsPkAsywoEHFKKdkkzwAryJoruI13DL0MPcM38nuba4MMzPq1EUrNuALiY4G1TYjh6xsXfOt%2B9CNFE4VHeUJOI2mALjw%3D%3D&Expires=1675898913" &


####### OK!!! next altas !!! ######
#######

A human cell atlas of fetal gene expression

####### CellXGene website ##########

mkdir /zp1/data/plyu3/Altas_add_CellAnn/Human_atlas_fetal

nohup curl -o local.rds "https://corpora-data-prod.s3.amazonaws.com/eaa5ade6-3207-4bbb-bfb8-025f2f917068/local.rds?AWSAccessKeyId=ASIATLYQ5N5X5C4BVZ42&Signature=xwjWG493gK505ALGRJSafU5UmAg%3D&x-amz-security-token=IQoJb3JpZ2luX2VjEFAaCXVzLXdlc3QtMiJHMEUCIAqUVzEPmniayMa69M5LSnZZWWYmWlUpIuJsem4epIQtAiEAkhehJ9sIohd1rChk2FADtI7PrAybFHS2tZdGzgHt4Z0q9AMIyf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARABGgwyMzE0MjY4NDY1NzUiDOodgVcp6c5Jt9m4VCrIA966Gx4Dd%2Fmebcuenh1JoMbG9sB75uQ28wmoJqfUhc5lQqPEUGrDSNqiaE6O9vuMdzJa6behkijPQI07FgxRzg8w4ZhUfxPUsalOSClcnHW0ql8WGWdoEFn1ML%2FYYqBbvGs68YU9vZ5UcQ7A3VMSqWXIhjSGO1FbBSvNqbADah2%2BGu03zk0PU1AEOCGepQQl81TmSQavHeB0rO9M3TD5LitUfD7Ppk1c54eErXl5cR3klxOGxSdgfCs69fTsKo4g%2BADz%2BxyBZLHSg9VP9vPFED%2FmrRAyCq9kFpPEDZ5ksZ6M2ISGGQT3DDLLSp0arNR4RD6he8NtguorccAOmu%2BLXimZpfVhp4Z2j3JAFtw8%2BX0ZWEPagEBLByP7mclv7z8n5Wt91wLq685BM%2BBdVIWGOOqat18Jlt8T0L4Dy4da0H1bzHPE28tCOJzBvT7JkuVGEmp6hEFG9fLo1pCDHOsI7y3mpsUmq6wMMdVrXH6JGn760XnXs7Rldlz3z0nL5ek3ZaMb9WXUoEBf4tc2%2FaQdDxPnxzO%2BJtVK7egQ7NNsnW03lxAcQnWtF0zxFlsQXDLqLlzqxjIlpob5wV8GmIyvGDZWbx4Heq4wwzDH6uueBjqlAbgBhEz3U51rIsL56oDTZ52psKNdK8MubOdTHb%2BWzdkTqRXqRB6AKMFCDPwYy6PF1o8rLbA8z%2FvfdtUli2ybnVac7xkKugxygYjxzdmdqPBMqosxpAhC6MsveM%2BdokybrzHmiO%2FZLweIOyU%2FL%2BUqUyAezO%2FUiiHzRGNk3tn4lLeRGtOKs6PQH1PaxcK4vioDvMu4XCctYZhFGgCaL0AdseJ6GbHn%2FA%3D%3D&Expires=1675900196" &

####### Next !!! ##################

Construction of a human cell landscape at single-cell level

####### Next !!! ##################

mkdir /zp1/data/plyu3/Altas_add_CellAnn/Human_cell_landscape

nohup curl -o local.rds "https://corpora-data-prod.s3.amazonaws.com/29308ce0-745f-486b-976b-1e58f612a91f/local.rds?AWSAccessKeyId=ASIATLYQ5N5XXMQ6XW2Q&Signature=szWcy%2F8fjioBuXkfwQoeedEoG%2FE%3D&x-amz-security-token=IQoJb3JpZ2luX2VjEEsaCXVzLXdlc3QtMiJGMEQCIE%2FqjGTtvaaPjL9PkiWtk%2FFN97YVBOmM6Dst5He4kCf4AiBZgakARMyvJnHQcoEbfnfrTnQe%2B1fkKtngtBXOsaWHACr0AwjE%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAEaDDIzMTQyNjg0NjU3NSIMwgT2MPXDACHbGtekKsgDENvyJh46atCnJuYMUz%2B7nYG8ByF6T%2FwNLoyYhgxLhlydoHXwXOB2pSzUmnOWxxET0fELWSr%2FXqo9Xs7Iqpyu%2F%2BqW2MtntacZbJz7adZkRLc1VLO4m9fPb2ehyyonQP3kDXZ%2Bo2%2BLsRrRgnfNV5scD6oqcUimcq%2FeyULRpyar5B6o%2B2kLT4PTpEbHKIcO1AmhFpLAXbALwzCf50KSdgdthUJgW4Cri5haEynNleufp%2Bp%2B6%2FMwJd3pb0fpqTw12gKi0qFv68PUryZI98Vky6uVXu01Vj4FUwi1AK9cA5iKJXT1zczt9XafILMarDpshaSNS1eJ9DAxh1z230IFUtFM6JEJGoD5grfXmBFMwldhErdbzXZTxlVHfAL6%2BRP3TauWWQ1n2Wk%2BUgqOe81mDQ7tloFzioR2zrW5jyEHZwSIT5X4IwN8eToF8OKWw1miEkeM2xLNJ5P0Vp8%2B6rPUDetcX5bsjsWiu1ZUv870Fs14Ys8H6zxPGKQeb4gTmSpZ%2BCHuMqGRAMMeEFVN32XlG%2BmRI%2BOB6Mo4lQEAwuOLfXYZgMjht6wT%2Bmwaf5AaA%2Ba%2F1%2FR0nbf1qZ275jmwf1aG%2FY%2B7gxMw4HmD8j8tMJLp6p4GOqYB7r9fD12pwaQiRlEiO3P%2F7TRHqyoKuE1iigNLOkbDd9Mdbl9BELecGQlWABSFG%2BqeNTaZvO0cYVjKdGBlNdLHak6vpcm%2FuOtUgcJnbOnpNZNNnKK5bbXOVdYFliQ1P21CJNiSbETHj21xDgLECTyDNstYxTnsVxzBZxReZbGoOa2nC5KYkDmD2tJg7KVk%2BnkMvgF4AFHjUiz4wHjH3kShUiTZwfE%2BiQ%3D%3D&Expires=1675900362" &


####### Next !!! ###################
MSK SPECTRUM – Ovarian cancer mutational processes drive site-specific immune evasion

mkdir /zp1/data/plyu3/Altas_add_CellAnn/Ovarian_cancer

nohup curl -o local.h5ad "https://corpora-data-prod.s3.amazonaws.com/b252b015-b488-4d5c-b16e-968c13e48a2c/local.h5ad?AWSAccessKeyId=ASIATLYQ5N5XXMQ6XW2Q&Signature=OCQJdJozuXyipgWU5GsCJT9DyYg%3D&x-amz-security-token=IQoJb3JpZ2luX2VjEEsaCXVzLXdlc3QtMiJGMEQCIE%2FqjGTtvaaPjL9PkiWtk%2FFN97YVBOmM6Dst5He4kCf4AiBZgakARMyvJnHQcoEbfnfrTnQe%2B1fkKtngtBXOsaWHACr0AwjE%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAEaDDIzMTQyNjg0NjU3NSIMwgT2MPXDACHbGtekKsgDENvyJh46atCnJuYMUz%2B7nYG8ByF6T%2FwNLoyYhgxLhlydoHXwXOB2pSzUmnOWxxET0fELWSr%2FXqo9Xs7Iqpyu%2F%2BqW2MtntacZbJz7adZkRLc1VLO4m9fPb2ehyyonQP3kDXZ%2Bo2%2BLsRrRgnfNV5scD6oqcUimcq%2FeyULRpyar5B6o%2B2kLT4PTpEbHKIcO1AmhFpLAXbALwzCf50KSdgdthUJgW4Cri5haEynNleufp%2Bp%2B6%2FMwJd3pb0fpqTw12gKi0qFv68PUryZI98Vky6uVXu01Vj4FUwi1AK9cA5iKJXT1zczt9XafILMarDpshaSNS1eJ9DAxh1z230IFUtFM6JEJGoD5grfXmBFMwldhErdbzXZTxlVHfAL6%2BRP3TauWWQ1n2Wk%2BUgqOe81mDQ7tloFzioR2zrW5jyEHZwSIT5X4IwN8eToF8OKWw1miEkeM2xLNJ5P0Vp8%2B6rPUDetcX5bsjsWiu1ZUv870Fs14Ys8H6zxPGKQeb4gTmSpZ%2BCHuMqGRAMMeEFVN32XlG%2BmRI%2BOB6Mo4lQEAwuOLfXYZgMjht6wT%2Bmwaf5AaA%2Ba%2F1%2FR0nbf1qZ275jmwf1aG%2FY%2B7gxMw4HmD8j8tMJLp6p4GOqYB7r9fD12pwaQiRlEiO3P%2F7TRHqyoKuE1iigNLOkbDd9Mdbl9BELecGQlWABSFG%2BqeNTaZvO0cYVjKdGBlNdLHak6vpcm%2FuOtUgcJnbOnpNZNNnKK5bbXOVdYFliQ1P21CJNiSbETHj21xDgLECTyDNstYxTnsVxzBZxReZbGoOa2nC5KYkDmD2tJg7KVk%2BnkMvgF4AFHjUiz4wHjH3kShUiTZwfE%2BiQ%3D%3D&Expires=1675901470" &

####### Next !!! ###################

Mapping the developing human immune system across organs

mkdir /zp1/data/plyu3/Altas_add_CellAnn/developing_human_immune_system

cd /zp1/data/plyu3/Altas_add_CellAnn/developing_human_immune_system

nohup curl -o local.rds "https://corpora-data-prod.s3.amazonaws.com/593125fb-7794-4a87-82db-2bb166072611/local.rds?AWSAccessKeyId=ASIATLYQ5N5XXMQ6XW2Q&Signature=JE6l%2F8xLDW1s9OFXYKJkJcqQo74%3D&x-amz-security-token=IQoJb3JpZ2luX2VjEEsaCXVzLXdlc3QtMiJGMEQCIE%2FqjGTtvaaPjL9PkiWtk%2FFN97YVBOmM6Dst5He4kCf4AiBZgakARMyvJnHQcoEbfnfrTnQe%2B1fkKtngtBXOsaWHACr0AwjE%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAEaDDIzMTQyNjg0NjU3NSIMwgT2MPXDACHbGtekKsgDENvyJh46atCnJuYMUz%2B7nYG8ByF6T%2FwNLoyYhgxLhlydoHXwXOB2pSzUmnOWxxET0fELWSr%2FXqo9Xs7Iqpyu%2F%2BqW2MtntacZbJz7adZkRLc1VLO4m9fPb2ehyyonQP3kDXZ%2Bo2%2BLsRrRgnfNV5scD6oqcUimcq%2FeyULRpyar5B6o%2B2kLT4PTpEbHKIcO1AmhFpLAXbALwzCf50KSdgdthUJgW4Cri5haEynNleufp%2Bp%2B6%2FMwJd3pb0fpqTw12gKi0qFv68PUryZI98Vky6uVXu01Vj4FUwi1AK9cA5iKJXT1zczt9XafILMarDpshaSNS1eJ9DAxh1z230IFUtFM6JEJGoD5grfXmBFMwldhErdbzXZTxlVHfAL6%2BRP3TauWWQ1n2Wk%2BUgqOe81mDQ7tloFzioR2zrW5jyEHZwSIT5X4IwN8eToF8OKWw1miEkeM2xLNJ5P0Vp8%2B6rPUDetcX5bsjsWiu1ZUv870Fs14Ys8H6zxPGKQeb4gTmSpZ%2BCHuMqGRAMMeEFVN32XlG%2BmRI%2BOB6Mo4lQEAwuOLfXYZgMjht6wT%2Bmwaf5AaA%2Ba%2F1%2FR0nbf1qZ275jmwf1aG%2FY%2B7gxMw4HmD8j8tMJLp6p4GOqYB7r9fD12pwaQiRlEiO3P%2F7TRHqyoKuE1iigNLOkbDd9Mdbl9BELecGQlWABSFG%2BqeNTaZvO0cYVjKdGBlNdLHak6vpcm%2FuOtUgcJnbOnpNZNNnKK5bbXOVdYFliQ1P21CJNiSbETHj21xDgLECTyDNstYxTnsVxzBZxReZbGoOa2nC5KYkDmD2tJg7KVk%2BnkMvgF4AFHjUiz4wHjH3kShUiTZwfE%2BiQ%3D%3D&Expires=1675901940" &


setwd('/zp1/data/plyu3/Altas_add_CellAnn/developing_human_immune_system')
seurat <- readRDS('local.rds')


####### 









####### Next !!! ##################

Tabula Muris Senis

mkdir /zp1/data/plyu3/Altas_add_CellAnn/Tabula_Muris_Senis_10X

cd /zp1/data/plyu3/Altas_add_CellAnn/Tabula_Muris_Senis_10X

nohup curl -o local.rds "https://corpora-data-prod.s3.amazonaws.com/d9e56525-f4f4-4f6b-a7a7-2b7d158f282b/local.rds?AWSAccessKeyId=ASIATLYQ5N5XUSUXQLXK&Signature=qzCfnSj7o301eEEy%2BEqSZFHoPuo%3D&x-amz-security-token=IQoJb3JpZ2luX2VjEFAaCXVzLXdlc3QtMiJGMEQCIE8iqLLTGfeH%2FBD2xw81I2uIczT%2FTLNO%2Fm3uIhHsyeqtAiBHL88mYV8U3IQPwiRaGV8OJO8bg2P6BVvrItlsZSM5sir0AwjJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAEaDDIzMTQyNjg0NjU3NSIMmYDqma5sMsWLcQ21KsgDWHWYlM27dhaxboMo%2BV7YBVaflWuGZaBocnWgGt1KILnlxqhEqllTWgjXZCiQ3pt87%2FCpokaEsZM09i4fiEv6hI7hU7Ec1y7%2FsPRBQ3RbTFCCg2kRESjEb4wJ5Yf9wfc2hnq8GxDhdtfTkXvgyFqDAPQKQ27%2BxR2JTyltdZ%2FyT%2FXxywXSEjCqT%2BVr6drXGv3dEoiqMrdsEAW46PyO%2Bmhwxvc96YHGm2%2BDHWtxTRqvilcLcWXfJXmkYuTmfd3aOS7%2FUAdrLZn8GKzo3FryNSne0mIXbf%2Bn2qWN8pYMFoWFzeppmO11aU%2FZ%2Fe4D%2BoC5su3swxYddh1LOp0HIGveXZQ5jeEKbG4EiHRKHYx%2FARCadZDPNNwDN9B9pcxySpf0hTbvlFOomPn%2BbnCpbl53Cx9SdhjtJA0b4EZ5UP2pPyuyNONXL5Hk8jz4Xh4%2BiN9AAeZWnlaEYFQSs4QiySDUdhVlWfLCyyfmKxGYtr5jJ7ORC8dAfF4L1c9Waf7Gxg8fmATZqUpfE65u%2BlZ66flctirufL0peOyvp8Zr%2FHFonblrKRLkWpYOjntcLHEBkS996j9F3z7qqjPigTmnESHC2NWZ%2FnQIyzerqhksMLn%2F654GOqYBO0OX2DEhiNr8S7lLZP%2FRBfOGsm%2B%2Bi%2BIfycpoQ9FNa%2FbO19djmzDaRAq7vum1V04lFXvmmIDfHNqmHamsAKC7fEGM8ya40IJ1bAevlStd5L8muezJNuV%2BzxSwBuOTXyz03wwhHlfINZP7WSUId6zQpCoEJaPVP1bOerQy5XFrZIQryEXwl2aP%2Fg%2B3po%2Bq9dIRUWHwvYsx4JHpFHvHz4aej6QCilWhlQ%3D%3D&Expires=1675902148" &

####### OK!!! then we split the seurat objects !!! ########
#######

seurat_split_obj <- SplitObject(seurat, split.by = "tissue")

for(i in 1:length(seurat_split_obj)){
	tag = names(seurat_split_obj)[i]
	tag = gsub(' ','_',tag)
	print(tag)
	####
	tmp_seurat = seurat_split_obj[[i]]
	####
	file = paste0(tag,'_seurat_obj')
	####
	saveRDS(tmp_seurat,file=file)
}


for(i in 1:length(seurat_split_obj)){
	tag = names(seurat_split_obj)[i]
	tag = gsub(' ','_',tag)
	print(tag)
	######
	folder = paste0("/zp1/data/plyu3/Altas_add_CellAnn/Tabula_Muris_Senis_10X/",tag,'10X')
	######
	TAG = "32669714_Tabula_Muris_10X"
	TAG = paste0(TAG,'_',tag)
	####
	

	####
	file = paste0(tag,'10X','/',tag,'_seurat_obj')
	####
	saveRDS(tmp_seurat2,file=file)
}



####### 
mkdir /zp1/data/plyu3/Altas_add_CellAnn/Tabula_Muris_Senis_Smartseq2

cd /zp1/data/plyu3/Altas_add_CellAnn/Tabula_Muris_Senis_Smartseq2

nohup curl -o local.rds "https://corpora-data-prod.s3.amazonaws.com/135b3e74-71b8-4c26-9e6b-2e6ec59d2306/local.rds?AWSAccessKeyId=ASIATLYQ5N5XYJYKESPS&Signature=DXD90cU9QRgLsXhHS5bJREjQnA0%3D&x-amz-security-token=IQoJb3JpZ2luX2VjEFAaCXVzLXdlc3QtMiJHMEUCIQCiQ6EFwqHUq%2BxUnXSkxX1nniqdWjKnKwWuWQKHDBL63AIgAa2qsqqaYG2FvlBIFv4EnvvtyNUJH6dqgKdRPTScHXQq9AMIyf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARABGgwyMzE0MjY4NDY1NzUiDBRG0Mo1KlZFgGWZoSrIA5pgy4PcdF8oyYg4ZQw%2FQrvTQyUJOqcISLsyc%2BqLFEsUp1PZ%2FL07qW%2FEy471PCSdhQV90d0PSHtEJx9Lfyzu2ogAmVQ7ssaBmdVqY%2BKxrU3t2ET5ARSOETmsNYjRZA%2FNBWm2RUX5t6%2FYtl93pllbY209Xrn6EdX3vpOtUMfNd7HCT%2BeaWsWQYWAO8fog6JGPQ%2FWvptRSqfwSv9yxrI6uSx%2FXCyAu4AvLWPLlCCBO84PGAu4i7C1oNbaf2oAODtnr2kYYDLbwFo%2Br1DZWKBulqKFiDpU8pVVdTcmW1QyLEX9EJeHkgGJ8YneHOYRlkmsjMsZT5hnTyEFaqmIudLUHiJa%2F%2BSNwxwc9aDdMQIL11CQbwrE8YTpHJV0BE6DFiYsD7IpRSPRD4YuUeuVFpWcJr84fWnre7EvqOFTBDK7CpLDq8p4%2BoLMEfgy5kCfLYDNl1LMoXP%2Bt3qrAgz1jTE2a68dWWC%2FvXB7JwqrJfabWQdMoWuq1R7BQGlgpu22cYFqGnJtsErCKwYbLBqIYEDPoLMdcqZZ8uSnofUefSnJ0ckWcuUjgr9maHc%2ByptSGg%2BNeT8JhespAHrD0ouEGzSDfiEdd%2FFny5AVxmDC%2B%2FOueBjqlAbSflGX5UYIAU5sxaNB7afe31wnvs9gQ81UnS6xcJB5PQOvZZysYuOYBr%2FT8xr8cZ5QEJriIysIrKpCtSwq5bJR18XXXq8GdAvnf0Vn2rsarR6f4avBoNALfSRyKLY2mYBMufVPS4BSm5KIDp3IKymevbVsvTn0JMJ05i7xHVc%2BCwzRJwIoSydceLhxIysVk0LkfYcbJzxT%2BptzfdzPGQBkfWyzmVA%3D%3D&Expires=1675902271" &

########

setwd('/zp1/data/plyu3/Altas_add_CellAnn/Tabula_Muris_Senis_Smartseq2')
seurat <- readRDS('local.rds')


#######
library('rtracklayer')

file = '/zp1/data/plyu3/Human_scATACseq_new/scATAC/Human_annotation/gencode.v38.basic.annotation.nochr.gtf'
gtf <- rtracklayer::import(file)
gtf_df <- as.data.frame(gtf)




gtf = rtracklayer::import('/zp1/data/plyu3/mouse_aging_res/gencode.vM10.basic.annotation.gtf.gz')
head(gtf)
gtf = data.frame(gtf)
gtf = gtf[which(gtf$type == 'gene'),]
gtf = gtf[which(gtf$gene_type == 'protein_coding'),]

gtf = gtf[,c(10,12)]

gtf$id = sapply(strsplit(as.character(gtf$gene_id),split='.',fixed=T),function(x) x[[1]])

saveRDS(gtf,file='/zp1/data/plyu3/Altas_add_CellAnn/Human_gene_convert')

saveRDS(gtf,file='/zp1/data/plyu3/Altas_add_CellAnn/Mouse_gene_convert')

gtf <- readRDS('/zp1/data/plyu3/Altas_add_CellAnn/Mouse_gene_convert')
########
seurat_split_obj <- SplitObject(seurat, split.by = "tissue")

for(i in 1:length(seurat_split_obj)){
	tag = names(seurat_split_obj)[i]
	tag = gsub(' ','_',tag)
	print(tag)
	####
	tmp_seurat = seurat_split_obj[[i]]
	####
	mat = tmp_seurat[['RNA']]@counts
	####
	m = match(rownames(mat),gtf$id)
	rownames(mat) = gtf$gene_name[m]
	k = which(is.na(rownames(mat)) == T)
	if(length(k) > 0){
		mat = mat[-k,]
	}
	####
	tmp_seurat2 = CreateSeuratObject(mat)
	tmp_seurat2@meta.data = tmp_seurat@meta.data
	tmp_seurat2$celltype = tmp_seurat2$cell_type
	####
	folder = paste0(tag,'10X')
	command = paste('mkdir',folder)
	system(command)
	####
	file = paste0(tag,'10X','/',tag,'_seurat_obj')
	####
	saveRDS(tmp_seurat2,file=file)
}


########
########
######## the last one !!!! ###########
########
########

Cross-tissue immune cell analysis reveals tissue-specific features in humans

mkdir /zp1/data/plyu3/Altas_add_CellAnn/Cross_tissue_immune_cell

cd /zp1/data/plyu3/Altas_add_CellAnn/Cross_tissue_immune_cell

nohup curl -o local.rds "https://corpora-data-prod.s3.amazonaws.com/229f8667-7318-4b5b-b6f2-c4cdae630130/local.rds?AWSAccessKeyId=ASIATLYQ5N5X6FZVAN7L&Signature=j3%2BRHAIQUO%2BvEZR07MRPgWDtTI4%3D&x-amz-security-token=IQoJb3JpZ2luX2VjEFAaCXVzLXdlc3QtMiJIMEYCIQDq3QHMRb8bxkNUulMZ9x%2BiqISJ2wL7vOJCBlivJPGVxgIhALkXjcfeyL74inEyI%2F7%2FTq0q6s3QU6hEwTegCNIV6HxmKvQDCMn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQARoMMjMxNDI2ODQ2NTc1IgzqZPcL2MQmiqfUHq8qyAO7VtDAGjLnC%2FFte74UiZTSPT2JASA5N%2FP86sANy3NKqWjcaCskPs8afQbXjR0s4tz2odfv8eERedm4NnU%2FXr5Cs%2BrEoR2eQNi%2BGDa83PACJecgkDWM03O0Hive3Gx9T%2BZUnJEwLu3uLZxUNzBARkB9J8Vu26ZrSIQmG%2BjqoWjH8b%2BJJVIEQCua%2FaCTzIbdsFYVxlaiRK83ZdM0a%2BR%2BUcBV3pTjfYsb8oTB5HCW4tztKqPXDnI1tyXU8zGM40cvgmai12rweqvF3V%2FkU1SFabaSFjYksGiEZvvwbUBR%2FR3MYgKZvfguc0gHU%2FKxQlNOWEE11OZ7KM%2FIG9YnlOvW8qIT6hTPFhdkg5XCZ%2BIrzQ0cQB887lPIbjPJlez6hhlN6PTSS6cn%2FUi3djWv5%2BDbUVYubuGR3DFfqvaLfA%2B8d%2ByfJ9iNTIJXBYrocfmeBIE8pLWkmJTiukn2ZRo51PBp0HJ4esGiZpAgxbHzzDjrFkXyeAUjQzhNGBiT%2FnkB60BACihHMsHy3IGZmVbTbeG3YySMC3DyrBmBrpm%2BMY%2BshqD%2BigvDsOmO8anLUFXP%2BrKYzil3nuxBVLtfPL8OPKkhgYpDKP9p%2FHWtOk0wjvzrngY6pAH1AStw1kw7ciigqMdupoHhjf5PyFSJRgdXiTbA%2BxMN9Sfe4dVZ7D9HJCTiEdMyylHkt1ut0XcmwDoyi7UmOzgpDk96JAOrcmCv0Y6V%2FXWYOyri015pv3maU8CTIboA6GSPd%2FTzPCl3cIJnQcSxbzbOJWWOL1Hdj6wflcCWQHXuyiBGe9y9PAzJW7i6blMMd4zr1LbaHzKbFQo5ZUGiDrO7ToKrUw%3D%3D&Expires=1675902738" &

setwd('/zp1/data/plyu3/Altas_add_CellAnn/Cross_tissue_immune_cell')
seurat <- readRDS('local.rds')

########
seurat_split_obj <- SplitObject(seurat, split.by = "tissue")
########



for(i in 1:length(seurat_split_obj)){
	tag = names(seurat_split_obj)[i]
	tag = gsub(' ','_',tag)
	print(tag)
	####
	tmp_seurat = seurat_split_obj[[i]]
	####
	file = paste0(tag,'_seurat_obj')
	####
	saveRDS(tmp_seurat,file=file)
}

########
########

load('/zp1/data/plyu3/Altas_add_CellAnn/Human_gene_convert')


for(i in 1:length(seurat_split_obj)){
	tag = names(seurat_split_obj)[i]
	tag = gsub(' ','_',tag)
	print(tag)
	####
	tmp_seurat = seurat_split_obj[[i]]
	####
	mat = tmp_seurat[['RNA']]@counts
	####
	m = match(rownames(mat),gtf$id)
	rownames(mat) = gtf$gene_name[m]
	k = which(is.na(rownames(mat)) == T)
	if(length(k) > 0){
		mat = mat[-k,]
	}
	####
	tmp_seurat2 = CreateSeuratObject(mat)
	tmp_seurat2@meta.data = tmp_seurat@meta.data
	tmp_seurat2$celltype = tmp_seurat2$cell_type
	####
	folder = paste0(tag,'Cross_tissue_immune')
	command = paste('mkdir',folder)
	system(command)
	####
	file = paste0(tag,'Cross_tissue_immune','/',tag,'_seurat_obj')
	####
	saveRDS(tmp_seurat2,file=file)
}






